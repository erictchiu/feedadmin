a:3:{s:5:"child";a:1:{s:0:"";a:1:{s:3:"rss";a:1:{i:0;a:6:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:7:"version";s:3:"2.0";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:0:"";a:1:{s:7:"channel";a:1:{i:0;a:6:{s:4:"data";s:51:"
	
	
	
	
	
	
	
	
	
			
		
		
		
		
		
		
		
		
		
	";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:3:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:22:"MySQL Performance Blog";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:35:"http://www.mysqlperformanceblog.com";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:34:"Everything about MySQL Performance";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:13:"lastBuildDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 23 Nov 2010 16:48:09 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:9:"generator";a:1:{i:0;a:5:{s:4:"data";s:28:"http://wordpress.org/?v=3757";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"language";a:1:{i:0;a:5:{s:4:"data";s:2:"en";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"item";a:10:{i:0;a:6:{s:4:"data";s:53:"
		
		
		
		
		
				
		
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:29:"Percona Server 5.1.52-rel11.6";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:77:"http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:86:"http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 23 Nov 2010 16:48:09 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:5:{i:0;a:5:{s:4:"data";s:8:"announce";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:7:"percona";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:7:"release";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:4;a:5:{s:4:"data";s:6:"xtradb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=4072";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:423:"Percona Server version 5.1.52-rel11.6 is now available for download.
The main purpose of this release is to update the current Percona stable release to the latest version of MySQL 5.1.
Functionality Added or Changed

 Percona Server 5.1.52-rel11.6 is now based on MySQL 5.1.52.
 New Features Added: None
 Other Changes: None

Bugs Fixed

Bug #671764 &#8211; innochecksum wasn&#8217;t distributed with RPM and .DEB [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:12:"Fred Linhoss";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:4778:"<p>Percona Server version 5.1.52-rel11.6 is now available for download.</p>
<p>The main purpose of this release is to update the current Percona stable release to the latest version of MySQL 5.1.</p>
<h3>Functionality Added or Changed</h3>
<ul>
<li> Percona Server 5.1.52-rel11.6 is now based on MySQL 5.1.52.</li>
<li> New Features Added: None</li>
<li> Other Changes: None</li>
</ul>
<h3>Bugs Fixed</h3>
<ul>
<li><a href="https://bugs.launchpad.net/bugs/671764">Bug #671764</a> &#8211; <tt><span style="font-size: medium;">innochecksum</span></tt> wasn&#8217;t distributed with RPM and .DEB packages. (Aleksandr Kuzminsky)</li>
<li><a href="https://bugs.launchpad.net/bugs/673426">Bug #673426</a> &#8211; Use of some system variables as command-line options caused a crash or undefined behavior. (Oleg Tsarev)</li>
<li><a href="https://bugs.launchpad.net/bugs/673929">Bug #673929</a> &#8211; Query cache misses were being reported for some queries when hits were actually occurring. (Oleg Tsarev)</li>
<li><a href="https://bugs.launchpad.net/bugs/676146">Bug #676146</a> &#8211; The development environment test of <tt><span style="font-size: medium;">log_slow_verbosity=innodb</span></tt> on a slave for row-based replication was not working correctly. (Oleg Tsarev)</li>
<li><a href="https://bugs.launchpad.net/bugs/676147">Bug #676147</a> &#8211; The development environment test of option <tt><span style="font-size: medium;">log_slow_slave_statements</span></tt> for row-based replication was not working correctly. (Oleg Tsarev)</li>
<li><a href="https://bugs.launchpad.net/bugs/676148">Bug #676148</a> &#8211; Similar to Bug #676147. A check is now made for the replication type to test. (Oleg Tsarev)</li>
<li><a href="https://bugs.launchpad.net/bugs/676158">Bug #676158</a> &#8211; Setting the query cache size to 512M caused test failure on low memory systems. (Aleksandr Kuzminsky)</li>
</ul>
<p>Release Notes for this and previous releases can be found in our <a href="http://www.percona.com/docs/wiki/percona-server:release_notes_51#percona_server_5152-rel116">Wiki</a>.</p>
<p>The latest downloads are available on our <a href="http://www.percona.com/downloads/Percona-Server-5.1/Percona-Server-5.1.52-11.6/" target="_blank">website</a>. The latest source code for Percona Server, including the development branch, can be found on <a href="https://launchpad.net/percona-server" target="_blank">Launchpad</a>.</p>
<p>Please report any bugs found at <a href="https://bugs.launchpad.net/percona-server/+filebug">Bugs in Percona Server</a>.</p>
<p>For general questions, use our <a href="http://groups.google.com/group/percona-discussion">Percona Discussions Group</a>, and for development questions our <a href="http://groups.google.com/group/percona-dev">Percona Development Group</a>.</p>
<p>For support, commercial, and sponsorship inquiries, contact <a href="http://www.percona.com/contacts.html">Percona</a>.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Fred Linhoss |
      <a href="http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/#comments">One comment</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/&amp;title=Percona Server 5.1.52-rel11.6" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/&amp;title=Percona Server 5.1.52-rel11.6" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/&amp;title=Percona Server 5.1.52-rel11.6" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/&amp;T=Percona Server 5.1.52-rel11.6" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/&amp;title=Percona Server 5.1.52-rel11.6" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:82:"http://www.mysqlperformanceblog.com/2010/11/23/percona-server-5-1-52-rel11-6/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:1;a:6:{s:4:"data";s:50:"
		
		
		
		
		
				
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:46:"Moving from MyISAM to Innodb or XtraDB. Basics";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:93:"http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:102:"http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 23 Nov 2010 02:39:57 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:4:{i:0;a:5:{s:4:"data";s:6:"Innodb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:6:"myisam";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:6:"xtradb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=4084";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:292:"I do not know if it is because we&#8217;re hosting a free webinar on migrating MyISAM to Innodb  or some other reason but recently I see a lot of questions about migration from MyISAM to Innodb. 
Webinar will cover the process in a lot more details though I would like to go over basics [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:5:"peter";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:5894:"<p>I do not know if it is because we&#8217;re hosting a <a href="http://www.percona.com/webinars/2010-12-01-migrating-myisam-innodb/">free webinar on migrating MyISAM to Innodb</a>  or some other reason but recently I see a lot of questions about migration from MyISAM to Innodb. </p>
<p>Webinar will cover the process in a lot more details though I would like to go over basics in advance.  You can also check my old post on this topic about <a href="http://www.mysqlperformanceblog.com/2009/01/12/should-you-move-from-myisam-to-innodb/">Moving MyISAM to Innodb</a> as well as <a href="http://www.mysqlperformanceblog.com/?s=myisam%20innodb&#038;search_posts=true">searching the blog</a> &#8211; We&#8217;ve blogged so much on this topic.</p>
<p>So what are  the basics ?</p>
<p><strong>Regression Benchmarks</strong>  &#8211; Make sure to run regression benchmarks in particular in terms of concurrent behavior. You may have hidden dependencies of MyISAM table lock behavior in your applications, also check if your application handled deadlocks well.  MyISAM will not produce deadlocks for Innodb you should always see deadlocks as a probability as long as you write to the database.  They may be rate but it is rather hard to guaranty you will never run into them.</p>
<p><strong>Performance Benchmarks</strong>  &#8211;  Innodb and MyISAM have different performance properties and you can&#8217;t really say one is faster than other it is very much workload dependent, and again concurrent tests should be important here.   Innodb also may result in different plans for some queries which is rather easy to check with <a href="http://www.maatkit.org/doc/mk-upgrade.html">mk-upgrade</a></p>
<p><strong>Feature Differences </strong>  &#8211; There are some feature differences between MyISAM and Innodb though well it is typically easily spotted by converting tables to Innodb on restored backup.  Full text search indexes, GIS,  multi-column auto increment keys are great examples.  There are also different limits for MyISAM and Innodb &#8211; it is possible to  have some rows which can be stored in MyISAM but would not fit to Innodb, though this is an exception. </p>
<p><strong>Space</strong>  Innodb Tables tend to be larger. Again converting schema will show you some of this. Though the best is to take a look at the size after stressing system with load for a while as depending on the schema and usage Innodb tables may increase in size significantly due to fragmentation.</p>
<p><strong>Usage Differences </strong> What works well for MyISAM may not work for Innodb and vice versa. You may benefit from different index structure for Innodb, including different primary key setup, as well as you may want to structure workload differently.   With MyISAM it is often for people to do updates in small chunks, almost row by row to avoid holding table lock for long time in Innodb you want larger updates to reduce cost of transaction commit. You also may want to avoid excessive SELECT COUNT(*) FROM TBL  (with no where clause) which is very fast for MyISAM but does table/index scan for Innodb.</p>
<p><strong>Defaults</strong>  You need to know two things about defaults for Innodb.  First Depending on MySQL version they may be somewhere from suboptimal to absolutely disastrous, you do not want to try to run Innodb or XtraDB with them.  Second Innodb is tuned to be ACID by default &#8211; if you&#8217;re moving from MyISAM often you do not need such strong guarantees and can at least change innodb_flush_log_at_trx_commit=2.  It still will be much more secure than storing data in MyISAM.  The 3 most important values to check are <strong>innodb_flush_log_at_trx_commit</strong>,  <strong>innodb_buffer_pool_size</strong> and <strong>innodb_log_file_size</strong>.   There are a lot more options for fine tuning but make sure at least these are right.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by peter |
      <a href="http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/#comments">One comment</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/&amp;title=Moving from MyISAM to Innodb or XtraDB. Basics" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/&amp;title=Moving from MyISAM to Innodb or XtraDB. Basics" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/&amp;title=Moving from MyISAM to Innodb or XtraDB. Basics" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/&amp;T=Moving from MyISAM to Innodb or XtraDB. Basics" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/&amp;title=Moving from MyISAM to Innodb or XtraDB. Basics" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:98:"http://www.mysqlperformanceblog.com/2010/11/22/moving-from-myisam-to-innodb-or-xtradb-basics/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:2;a:6:{s:4:"data";s:59:"
		
		
		
		
		
				
		
		
		
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:22:"Percona XtraBackup 1.4";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:70:"http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:79:"http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Mon, 22 Nov 2010 19:27:02 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:7:{i:0;a:5:{s:4:"data";s:7:"Backups";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:6:"Innodb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:8:"announce";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:4;a:5:{s:4:"data";s:7:"percona";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:5;a:5:{s:4:"data";s:7:"release";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:6;a:5:{s:4:"data";s:6:"xtradb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=3803";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:425:"Percona XtraBackup 1.4 is now available for download.
Version 1.4 fixes problems related to incremental backups. If you do incremental backups, it&#8217;s strongly recommended that you upgrade to this release.
Functionality Added or Changed

Incremental backups have changed and now allow the restoration of full backups containing certain rollback transactions that previously caused problems. Please see Preparing the [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:12:"Fred Linhoss";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:5912:"<p>Percona XtraBackup 1.4 is now available for download.</p>
<p>Version 1.4 fixes problems related to incremental backups. If you do incremental backups, it&#8217;s strongly recommended that you upgrade to this release.</p>
<h3>Functionality Added or Changed</h3>
<ul>
<li><a href="http://www.percona.com/docs/wiki/percona-xtrabackup:xtrabackup:incremental">Incremental backups</a> have changed and now allow the restoration of full backups containing certain rollback transactions that previously caused problems. Please see <a href="http://www.percona.com/docs/wiki/percona-xtrabackup:xtrabackup:incremental#Preparing_the_Backups">Preparing the Backups</a> and the <tt><span style="font-size: medium;">--apply-log-only</span></tt> <a href="http://www.percona.com/docs/wiki/percona-xtrabackup:xtrabackup:option-and-variable-reference">option</a>. (From <tt><span style="font-size: medium;">innobackupex</span></tt>, the <tt><span style="font-size: medium;">--redo-only</span></tt> option should be used). (Yasufumi Kinoshita)</li>
<li>The XtraBackup Test Suite was implemented and is now a standard part of each distribution. (Aleksandr Kuzminsky)</li>
<li>Other New Features:
<ul>
<li>The <tt><span style="font-size: medium;">--prepare</span></tt> <a href="http://www.percona.com/docs/wiki/percona-xtrabackup:xtrabackup:option-and-variable-reference">option</a> now reports <tt><span style="font-size: medium;">xtrabackup_binlog_pos_innodb</span></tt> if the information exists. (Yasufumi Kinoshita)</li>
<li>When <tt><span style="font-size: medium;">--prepare</span></tt> is used to restore a partical backup, the data dictionary is now cleaned and contains only tables that exist in the backup. (Yasufumi Kinoshita))</li>
<li>The <tt><span style="font-size: medium;">--table</span></tt> <a href="http://www.percona.com/docs/wiki/percona-xtrabackup:xtrabackup:option-and-variable-reference">option</a> was extended to accept several regular expression arguments, separated by commas. (Yasufumi Kinoshita)</li>
</ul>
</li>
<li>Other Changes:
<ul>
<li>Ported to the Percona Server 5.1.47-11 code base. (Yasufumi Kinoshita)</li>
<li>XtraBackup now uses the memory allocators of the host operating system, rather than the built-in InnoDB allocators (see <a href="http://dev.mysql.com/doc/innodb-plugin/1.1/en/innodb-performance-use_sys_malloc.html">Using Operating System Memory Allocators</a>). (Yasufumi Kinoshita)</li>
</ul>
</li>
</ul>
<h3>Bugs Fixed</h3>
<ul>
<li><a href="https://bugs.launchpad.net/bugs/595770">Bug #595770</a> &#8211; Binaries are stripped by <tt><span style="font-size: medium;">rpmbuild</span></tt>, so <tt><span style="font-size: medium;">__os_install_post</span></tt> is redefined to change the default behaviour. (Aleksandr Kuzminsky)</li>
<li><a href="https://bugs.launchpad.net/bugs/589639">Bug #589639</a> &#8211; Fixed a problem of hanging when tablespaces were deleted during the recovery process. (Yasufumi Kinoshita)</li>
<li><a href="https://bugs.launchpad.net/bugs/611960">Bug #611960</a> &#8211; Fixed a segmentation fault in &#8220;xtrabackup&#8221;. (Yasufumi Kinoshita)</li>
<li>Miscellaneous important fixes related to incremental backups.</li>
</ul>
<p>Release Notes for this and previous releases of Percona Xtrabackup can be found in our <a href="http://www.percona.com/docs/wiki/percona-xtrabackup:release-notes">Wiki</a>.</p>
<p>The latest downloads are available on our <a href="http://www.percona.com/downloads/XtraBackup/LATEST/" target="_blank">website</a>. The latest source code can be found on <a href="https://launchpad.net/percona-xtrabackup" target="_blank">Launchpad</a>.</p>
<p>Please report any bugs found at <a href="https://bugs.launchpad.net/percona-xtrabackup/+filebug">Bugs in Percona XtraBackup</a>.</p>
<p>For general questions, use our <a href="http://groups.google.com/group/percona-discussion">Percona Discussions Group</a>, and for development questions our <a href="http://groups.google.com/group/percona-dev">Percona Development Group</a>.</p>
<p>For support, commercial, and sponsorship inquiries, contact <a href="http://www.percona.com/contacts.html">Percona</a>.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Fred Linhoss |
      <a href="http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/#comments">5 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/&amp;title=Percona XtraBackup 1.4" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/&amp;title=Percona XtraBackup 1.4" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/&amp;title=Percona XtraBackup 1.4" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/&amp;T=Percona XtraBackup 1.4" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/&amp;title=Percona XtraBackup 1.4" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:75:"http://www.mysqlperformanceblog.com/2010/11/22/percona-xtrabackup-1-4/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"5";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:3;a:6:{s:4:"data";s:44:"
		
		
		
		
		
				
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:42:"Is there benefit from having more memory ?";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:88:"http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:97:"http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Sat, 20 Nov 2010 02:38:06 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:2:{i:0;a:5:{s:4:"data";s:10:"benchmarks";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:8:"fusionio";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=4059";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:400:"My post back in April, http://www.mysqlperformanceblog.com/2010/04/08/fast-ssd-or-more-memory/, caused quite interest, especially on topic SSD vs Memory.
That time I used fairy small dataset, so it caused more questions, like, should we have more then 128GB of memory?
If we use fast solid state drive, should we still be looking to increase memory, or that configuration provides best possible [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:5:"Vadim";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:4128:"<p>My post back in April, <a href="http://www.mysqlperformanceblog.com/2010/04/08/fast-ssd-or-more-memory/">http://www.mysqlperformanceblog.com/2010/04/08/fast-ssd-or-more-memory/</a>, caused quite interest, especially on topic SSD vs Memory.</p>
<p>That time I used fairy small dataset, so it caused more questions, like, should we have more then 128GB of memory?<br />
If we use fast solid state drive, should we still be looking to increase memory, or that configuration provides best possible performance.</p>
<p>To address this, I took  <a href="http://www.percona.com/docs/wiki/benchmark:hardware:cisco_ucs_c250">Cisco UCS C250 server</a> in our lab, with 384GB of memory and FusionIO 320GB MLC. I generated 230GB data for sysbench benchmark<br />
and run read-only and read-write OLTP workload with varying buffer pool size from 50 to 300GB (with O_DIRECT setting, so<br />
os cache is not used)</p>
<p>This allows as to see effect of having more memory available.</p>
<p>The graph result is:</p>
<p><a href="http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/performance_vs_memory.png"><img src="http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/performance_vs_memory.png" alt="" title="performance_vs_memory" width="545" height="301" class="aligncenter size-full wp-image-4060" /></a></p>
<p>and raw numbers are on <a href="http://www.percona.com/docs/wiki/benchmark:cisco:memory.start">Wiki bencmarks</a></p>
<p>So let&#8217;s take detailed look on numbers with 120GB ( as if you have system with 128GB of RAM) and 250GB</p>
<table border=1>
<tr>
<td>Buffer_pool</td>
<td>read-only, tps</td>
<td>read-write, tps</td>
</tr>
<tr>
<td>120GB</td>
<td>1866.87</td>
<td>2547.69</td>
</tr>
<tr>
<td>250GB</td>
<td>5656.62 (ratio 3x) </td>
<td>7633.38 (ratio 2.99) </td>
</tr>
</table>
<p>So you see doubling memory gives 3x ! performance improvement. And it is despite we store data on one of fastest available storage.</p>
<p>So to get best possible performance our advise is still the same &#8211; you should try to fit your active dataset into memory, and it is possible as nowadays systems with 300GB+ RAM already available.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Vadim |
      <a href="http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/#comments">2 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/&amp;title=Is there benefit from having more memory ?" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/&amp;title=Is there benefit from having more memory ?" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/&amp;title=Is there benefit from having more memory ?" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/&amp;T=Is there benefit from having more memory ?" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/&amp;title=Is there benefit from having more memory ?" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:93:"http://www.mysqlperformanceblog.com/2010/11/19/is-there-benefit-from-having-more-memory/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"2";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:4;a:6:{s:4:"data";s:47:"
		
		
		
		
		
				
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:50:"Percona white paper: Forecasting MySQL Scalability";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:97:"http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:106:"http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 16 Nov 2010 18:07:26 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:3:{i:0;a:5:{s:4:"data";s:8:"announce";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:11:"Scalability";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=4031";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:361:"Ewen and I have just published Percona&#8217;s latest white paper, Forecasting  MySQL Scalability with the Universal Scalability Law.  This is essentially a streamlined walk-through of Dr. Neil J. Gunther&#8217;s book Guerrilla Capacity Planning, with examples to show how you can apply it to MySQL servers.
One thing alluded to in the paper is extracting [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:14:"Baron Schwartz";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:3575:"<p>Ewen and I have just published Percona&#8217;s latest <a href="http://www.percona.com/about-us/white-papers/">white paper</a>, <em>Forecasting  MySQL Scalability with the Universal Scalability Law</em>.  This is essentially a streamlined walk-through of Dr. Neil J. Gunther&#8217;s book <em>Guerrilla Capacity Planning</em>, with examples to show how you can apply it to MySQL servers.</p>
<p>One thing alluded to in the paper is extracting the necessary metrics from network traffic.  I had this idea after studying the data in Linux&#8217;s /proc/diskstats file.  It turns out that two simple metrics can provide amazingly rich insight into system performance and scalability,  in combination with Little&#8217;s Law and queueing theory.  These are the busy time and the total time that requests were resident in the system.  There are different terms for the latter, but in MySQL we&#8217;d call it query response time.  After studying these for a few months, I&#8217;m so awed by how useful they are that I am going to make a blanket recommendation: if you create server software, you <em>must</em> expose these simple metrics.  (I have filed a <a href="https://bugs.launchpad.net/percona-server/+bug/666597">feature request for Percona Server</a> to add these metrics for MySQL users.)</p>
<p>I&#8217;ll probably follow this up with another blog post or white paper at some point in the future, to show how to use the busy time and query response time to predict a system&#8217;s scalability.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Baron Schwartz |
      <a href="http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/#comments">3 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/&amp;title=Percona white paper: Forecasting MySQL Scalability" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/&amp;title=Percona white paper: Forecasting MySQL Scalability" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/&amp;title=Percona white paper: Forecasting MySQL Scalability" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/&amp;T=Percona white paper: Forecasting MySQL Scalability" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/&amp;title=Percona white paper: Forecasting MySQL Scalability" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:102:"http://www.mysqlperformanceblog.com/2010/11/16/percona-white-paper-forecasting-mysql-scalability/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"3";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:5;a:6:{s:4:"data";s:50:"
		
		
		
		
		
				
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:41:"Percona is looking for a Support Engineer";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:89:"http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:98:"http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 16 Nov 2010 16:51:18 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:4:{i:0;a:5:{s:4:"data";s:7:"percona";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:7:"careers";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:6:"hiring";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:7:"support";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=3917";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:413:"As part of our growth process and with the introduction of our Support and Maintenance services, we're looking for a new Support Engineer.

You would be a part of a unit that operates 24x7 and be the first line of contact for our customers.

Responsibilities include handling or dispatching emergencies and support requests, triaging incoming issues, and ensuring customers always get the attention they need.";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:13:"Fernando Ipar";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:3997:"<p>As part of our growth process and with the introduction of our <a title="Percona Support &amp; Maintenance for MySQL" href="http://www.percona.com/support/overview/">Support and Maintenance</a> services, we&#8217;re looking for a new Support Engineer.</p>
<p>You would be a part of a unit that operates 24&#215;7 and be the first line of contact for our customers.</p>
<p>Responsibilities include handling or dispatching emergencies and support requests, triaging incoming issues, and ensuring customers always get the attention they need.</p>
<p>The requirements for the position are:<br />
* Excellent written and spoken English<br />
* Knowledge of MySQL and InnoDB<br />
* Knowledge of Linux or other UNIX type systems administration<br />
* Knowledge of popular LAMP technologies such as Apache<br />
* Detail oriented<br />
* Service oriented<br />
* Proven success working in a distributed environment where e-mail, IRC and voice calls are the only interaction with colleagues, managers and customers</p>
<p>You should be able to assist customers with requests such as query optimization, replication problems, reproducing bugs and general mysql administration and use inquires, among other things.</p>
<p>Work is scheduled in 8-hour shifts, with 2 consecutive days off every week, only one of which is guaranteed to fall on the weekend. The specific shift we want covered with this opening is 14 &#8211; 22 Pacific time, though some 22 &#8211; 06 Pacific time shifts may be required occasionally.</p>
<p>Some of the advantages of working for Percona include good pay and benefits, working from home, with a team of experts who deal with challenging projects everyday and who are actively involved in the development community around MySQL.</p>
<p>Some travel is required to a yearly company meeting and to regional conferences and events.</p>
<p>If this sounds like you, please get in touch using our <a title="Careers contact form" href="http://www.percona.com/contact/careers/">contact</a> form. Thanks!</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Fernando Ipar |
      <a href="http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/#comments">No comment</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/&amp;title=Percona is looking for a Support Engineer" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/&amp;title=Percona is looking for a Support Engineer" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/&amp;title=Percona is looking for a Support Engineer" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/&amp;T=Percona is looking for a Support Engineer" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/&amp;title=Percona is looking for a Support Engineer" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:94:"http://www.mysqlperformanceblog.com/2010/11/16/percona-is-looking-for-a-support-engineer/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:6;a:6:{s:4:"data";s:56:"
		
		
		
		
		
				
		
		
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:57:"The perils of uniform hardware and RAID auto-learn cycles";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:108:"http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:117:"http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 16 Nov 2010 16:40:56 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:6:{i:0;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:9:"AutoLearn";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:4:"Dell";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:7:"MegaCLI";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:4;a:5:{s:4:"data";s:8:"MegaRAID";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:5;a:5:{s:4:"data";s:4:"PERC";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=4026";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:319:"Last night a customer had an emergency in selected machines on a large cluster of quite uniform database servers.  Some of the servers were slowing down in a very puzzling way over a short time span (a couple of hours).  Queries were taking multiple seconds to execute instead of being practically instantaneous.  [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:14:"Baron Schwartz";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:5767:"<p>Last night a customer had an emergency in selected machines on a large cluster of quite uniform database servers.  Some of the servers were slowing down in a very puzzling way over a short time span (a couple of hours).  Queries were taking multiple seconds to execute instead of being practically instantaneous.  But nothing seemed to have changed.  No increase in traffic, no code changes, nothing.  Some of the servers got sick and then well again; others that seemed to be identical were still sick; others hadn&#8217;t shown any symptoms yet.  The servers were in master-master pairs, and the reads were being served entirely from the passive machine in the pair.  The servers that were having trouble were the active ones, those accepting writes.</p>
<p>The customer had graphs of system metrics (++customer), and the symptoms we observed were that Open_tables went sharply up, the buffer pool got more dirty pages, InnoDB started creating more pages, and the percentage of dirty pages in the buffer pool went up.  In addition, samples of SHOW INNODB STATUS showed a long pending flush list (hundreds), and usually one pending pwrite.</p>
<p>After talking through things for a bit, I mentally eliminated a number of possibilities.  For example, there was no shared storage; servers were on different network segments and in different racks; and so on.  I had two remaining possibilities.</p>
<ol>
<li>The data had changed subtly, pushing it over some threshold.  I&#8217;ve seen this before &#8212; for example, a query cache bottleneck, or an insert buffer bottleneck, or any of a variety of other things.</li>
<li>Rather than looking for differences between the servers, it might be fruitful to look at what was uniform about them.</li>
</ol>
<p>The next step would be to measure precisely what was happening, but before even doing that, I wanted to chase down a small hunch that would only take a minute.  I asked the customer whether the servers were all the same.  Were they in the same shipment from the manufacturer?  Did they have hard drives from a single manufacturing batch?  It turned out that the servers were all part of a single shipment, and not only that, but they had been rebooted simultaneously pretty recently.   I asked the customer to check the RAID controller quickly on one of the failing machines.</p>
<p>The result: the battery-backed cache was in write-through mode instead of write-back mode, and the battery was at 33% and charging.  We quickly checked a few other sick machines.  Same thing &#8212; write-through, battery charging.  And the battery backup unit was set to run through auto-learn cycles periodically, which is generally the factory default (these are Dells, with PERC / LSI MegaRAID controllers.)</p>
<p>I opened my quick-reference text file and found the command we needed to disable auto-learn,  (++text files and saving <a href="http://yo61.com/dell-drac-bbu-auto-learn-tests-kill-disk-performance.html">links to reference material</a>), sent that over the Skype chat, and the customer tried that.  We weren&#8217;t sure the auto-learn could be stopped in the middle, but it worked.  They hung up and hurried to push this out with Puppet before it hit hundreds of other machines.</p>
<p>I have heard stories before of uniform hardware causing a cluster of problems, such as a bad batch of hard drives all failing close together, but this is the first time that I remember being involved in such a case myself.  It was kind of fun that I didn&#8217;t actually have to get all measurement-y and scientific about the problem after all.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Baron Schwartz |
      <a href="http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/#comments">15 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/&amp;title=The perils of uniform hardware and RAID auto-learn cycles" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/&amp;title=The perils of uniform hardware and RAID auto-learn cycles" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/&amp;title=The perils of uniform hardware and RAID auto-learn cycles" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/&amp;T=The perils of uniform hardware and RAID auto-learn cycles" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/&amp;title=The perils of uniform hardware and RAID auto-learn cycles" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:113:"http://www.mysqlperformanceblog.com/2010/11/16/on-the-perils-of-uniform-hardware-and-raid-auto-learn-cycles/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:2:"15";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:7;a:6:{s:4:"data";s:56:"
		
		
		
		
		
				
		
		
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:39:"Shard-Query adds parallelism to queries";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:87:"http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:96:"http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Mon, 15 Nov 2010 20:27:14 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:6:{i:0;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:6:"Innodb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:18:"InnoDB Performance";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:4:"OLAP";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:4;a:5:{s:4:"data";s:11:"performance";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:5;a:5:{s:4:"data";s:8:"sharding";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=2875";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:376:"Preamble: On performance, workload and scalability:
MySQL has always been focused on OLTP workloads.  In fact, both Percona Server and MySQL 5.5.7rc have numerous performance improvements which benefit workloads that have high concurrency.     Typical OLTP workloads feature numerous clients (perhaps hundreds or thousands) each reading and writing small chunks of data. [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:15:"Justin Swanhart";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:32397:"<p><strong>Preamble: On performance, workload and scalability:</strong><br />
MySQL has always been focused on OLTP workloads.  In fact, both Percona Server and MySQL 5.5.7rc have numerous performance improvements which benefit workloads that have high concurrency.     Typical OLTP workloads feature numerous clients (perhaps hundreds or thousands) each reading and writing small chunks of data.  The recent improvements to MySQL make it <i>scale</i> better for this workload when more resources (such as additional CPUs) are added.  By <i>scaling better</i> I mean that it is able to take advantage of all available resources in order to handle the workload.  One reason that it works best for this workload is that a single query executes in a single thread.  MySQL never takes advantage of more than a single CPU when aggregating data and fetching rows from the buffer pool, with respect to a single query, but it can run many queries at once.</p>
<p>There are workloads other than OLTP and the recent optimizations to MySQL still leave a lot of low hanging fruit where these are concerned.  This is particularly true for OLAP workloads.  While I'm not going to diverge into a discussion of how OLAP varies from OLTP, it suffices to say that a typical OLAP workload features a low number of concurrent queries which each examine large amounts of data.  Since a single query is single threaded in MySQL, the new optimizations don't really help with this workload.</p>
<p>The following tests assume a workload consisting of a small number of concurrent queries (or only one) to demonstrate how much improvement could be made to MySQL so that is could better utilize all available resources (that is, scale better) when running small numbers of queries which examine a lot of data.  </p>
<p><strong>What is Shard-Query?</strong><br />
<a href="http://code.google.com/p/shard-query">Shard-Query</a> was initially conceived as a utility to add parallelism to horizontally partitioned data sets by running queries against each host in parallel, with the added feature of supporting aggregation.  Then I hit upon the idea of taking SQL constructs like IN and BETWEEN and making these queries execute in parallel <em>on a each host</em>.   If you have a sharded data set, then this gives you the opportunity for additional parallelism for each query.  If you have only a single server, but it has enough resources to answer queries in parallel, then it can be used to add parallelism to queries which use IN or BETWEEN clauses.  This added parallelism can have significant performance advantages as demonstrated in this blog post.</p>
<p>Many database servers can add this parallelism natively, but most of those are not open source.  In the future, Shard-Query can be extended to other database servers such as PostgreSQL or Firebird fairly easily.</p>
<p><strong>What machine did I use?</strong></p>
<p>I used MySQL 5.5.7rc on a <a href="http://www.percona.com/docs/wiki/benchmark:hardware:cisco_ucs_c250">powerful Cisco UCS</a> server with 12 real cores and 384GB of ram.  The amount of ram is significantly larger than my already hefty 55GB testing data set, so this means that if MySQL could fully utilize all cores for my workload, then this test would be CPU bound.  </p>
<p><strong>What data did I use?</strong><br />
I loaded 55GB of the same data used in <a href="http://www.mysqlperformanceblog.com/2009/10/02/analyzing-air-traffic-performance-with-infobright-and-monetdb/">this earlier post</a> into a partitioned InnoDB table.  </p>
<p>Partitioning example:</p>
<div class="igBar"><span id="lsql-4"><a href="#" onclick="javascript:showPlainTxt('sql-4'); return false;">PLAIN TEXT</a></span></div>
<div class="syntax_hilite"><span class="langName">SQL:</span>
<div id="sql-4">
<div class="sql">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">/*!50500 PARTITION BY RANGE&nbsp; COLUMNS(FlightDate)</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">(PARTITION p2 VALUES LESS THAN ('1988-01-01') ENGINE = InnoDB,</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">PARTITION p3 VALUES LESS THAN ('1988-02-01') ENGINE = InnoDB,</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">...</span></div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">PARTITION p253 VALUES LESS THAN ('2008-12-01') ENGINE = InnoDB,</span></div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #808080; font-style: italic;">PARTITION p254 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB) */</span> </div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p><strong>What queries did I use?</strong><br />
I used a version of the queries in <a href="http://www.mysqlperformanceblog.com/2009/10/02/analyzing-air-traffic-performance-with-infobright-and-monetdb/">that same blog post</a>.  The original queries tend to filter on the Year column.  I partitioned the table into months using the FlightDate column using the improved MySQL 5.5 partitioning options which work directly on columns without the need to use TO_DAYS.  To accommodate my partitioning schema I modified the queries to use the FlightDate column instead of the Year column.  See the "full disclosure" section at the end for the complete SQL.</p>
<p>These tests were done using 'run_query.php', which is the example application which comes with Shard-Query.  As the name implies, it takes a list of queries in a file (or stdin) and a config file.  It runs the SQL via ShardQuery and it prints the results.</p>
<p><strong>Test #1</strong><br />
This set of queries tests the most basic aggregation (<strong>count(*)</strong>) on a range of records.  This table is partitioned by month which means that MySQL can use <a href="http://dev.mysql.com/doc/refman/5.1/en/partitioning-pruning.html">partition pruning</a> to reduce the amount of data which must be examined.  With this in mind, I modified Vadim's queries to use the FlightDate column in the WHERE clause instead of Year.  </p>
<p>Each iteration reads an additional year of data.  That is, the first query reads one year, and the last query reads 21 years  of collected flight data. </p>
<p>For example (the final query):</p>
<div class="igBar"><span id="lsql-5"><a href="#" onclick="javascript:showPlainTxt('sql-5'); return false;">PLAIN TEXT</a></span></div>
<div class="syntax_hilite"><span class="langName">SQL:</span>
<div id="sql-5">
<div class="sql">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;"><span style="color: #993333; font-weight: bold;">SELECT</span> count<span style="color:#006600; font-weight:bold;">&#40;</span>*<span style="color:#006600; font-weight:bold;">&#41;</span> </div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp; &nbsp;<span style="color: #993333; font-weight: bold;">FROM</span> ontime.ontime&nbsp; </div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;<span style="color: #993333; font-weight: bold;">WHERE</span> FlightDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'1988-01-01'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'2008-12-31'</span>; </div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p><center><br />
<a href="http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/shard_query_test1.png"><img src="http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/shard_query_test1.png" alt="Graph shows shard query is more scalable than regular MySQL" title="shard_query_test#1" width="600" height="371" class="aligncenter size-full wp-image-3949" /></a></p>
<p><meta http-equiv="content-type" content="text/html; charset=UTF-8"/><meta name='lsq' content='24'/><meta name='trixrows' content='101'/><meta name='trixr1' content='0'/><meta name='trixr2' content='22'/><meta name='trixdiv' content='20'/><meta name='trixcnt' content='2'/><meta name='trixlast' content='2'/>
<link rel=stylesheet href="//spreadsheets.google.com/client/css/552456475-trix_main-ssl.css" type="text/css">
<style>.tblGenFixed td {padding:0 3px;overflow:hidden;white-space:normal;letter-spacing:0;word-spacing:0;background-color:#fff;z-index:1;border-top:0px none;border-left:0px none;border-bottom:1px solid #CCC;border-right:1px solid #CCC;} .dn {display:none} .tblGenFixed td.s0 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:left;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-top:1px solid #CCC;border-right:1px solid #CCC;border-bottom:1px solid #CCC;border-left:1px solid #CCC;} .tblGenFixed td.s2 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:left;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-right:1px solid #CCC;border-bottom:1px solid #CCC;border-left:1px solid #CCC;} .tblGenFixed td.s1 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:left;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-top:1px solid #CCC;border-right:1px solid #CCC;border-bottom:1px solid #CCC;} .tblGenFixed td.s3 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:right;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-right:1px solid #CCC;border-bottom:1px solid #CCC;} </style>
<p></head><body style='border:0px;margin:0px'><br />
<table border=0 cellpadding=0 cellspacing=0 id='tblMain'>
<tr>
<td>
<table border=0 cellpadding=0 cellspacing=0 class='tblGenFixed' id='tblMain_0'>
<tr class='rShim'>
<td class='rShim' style='width:0;'>
<td class='rShim' style='width:77px;'>
<td class='rShim' style='width:120px;'>
<td class='rShim' style='width:67px;'>
<td class='rShim' style='width:67px;'>
<td class='rShim' style='width:67px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s0'>Period
<td  class='s1'>No Shard-Query
<td  class='s1'>16 worker
<td  class='s1'>24 worker
<td  class='s1'>32 worker
<td  class='s1 dn'>No Shard-Query
<td  class='s1 dn'>16 worker
<td  class='s1 dn'>24 worker
<td  class='s1 dn'>32 worker</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>1 year
<td  class='s3'>4.548
<td  class='s3'>1.044
<td  class='s3'>0.854
<td  class='s3'>0.852
<td  class='s3 dn'>4.548445224762
<td  class='s3 dn'>1.0439739227295
<td  class='s3 dn'>0.85434007644653
<td  class='s3 dn'>0.85227012634277</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>2 year
<td  class='s3'>8.408
<td  class='s3'>1.769
<td  class='s3'>0.98
<td  class='s3'>0.931
<td  class='s3 dn'>8.4081881046295
<td  class='s3 dn'>1.7690436840057
<td  class='s3 dn'>0.9801869392395
<td  class='s3 dn'>0.93061804771423</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>3 year
<td  class='s3'>11.97
<td  class='s3'>2.225
<td  class='s3'>0.975
<td  class='s3'>1.276
<td  class='s3 dn'>11.970124006271
<td  class='s3 dn'>2.2246358394623
<td  class='s3 dn'>0.97536420822144
<td  class='s3 dn'>1.2755739688873</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>4 year
<td  class='s3'>16.261
<td  class='s3'>2.98
<td  class='s3'>1.393
<td  class='s3'>1.427
<td  class='s3 dn'>16.260906934738
<td  class='s3 dn'>2.9798262119293
<td  class='s3 dn'>1.392954826355
<td  class='s3 dn'>1.4265050888062</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>5 year
<td  class='s3'>20.567
<td  class='s3'>3.905
<td  class='s3'>1.834
<td  class='s3'>1.83
<td  class='s3 dn'>20.566961050034
<td  class='s3 dn'>3.9051797389984
<td  class='s3 dn'>1.8339827060699
<td  class='s3 dn'>1.829803943634</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>6 year
<td  class='s3'>24.186
<td  class='s3'>4.234
<td  class='s3'>1.881
<td  class='s3'>1.92
<td  class='s3 dn'>24.186297893524
<td  class='s3 dn'>4.2335538864136
<td  class='s3 dn'>1.8810119628906
<td  class='s3 dn'>1.9195370674133</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>7 year
<td  class='s3'>27.589
<td  class='s3'>4.833
<td  class='s3'>2.248
<td  class='s3'>2.143
<td  class='s3 dn'>27.589097976685
<td  class='s3 dn'>4.8326716423035
<td  class='s3 dn'>2.2480010986328
<td  class='s3 dn'>2.1432509422302</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>8 year
<td  class='s3'>32.148
<td  class='s3'>5.612
<td  class='s3'>2.447
<td  class='s3'>2.496
<td  class='s3 dn'>32.147665023804
<td  class='s3 dn'>5.6120498180389
<td  class='s3 dn'>2.4470851421356
<td  class='s3 dn'>2.4959940910339</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>9 year
<td  class='s3'>35.904
<td  class='s3'>6.205
<td  class='s3'>2.848
<td  class='s3'>2.739
<td  class='s3 dn'>35.903709173203
<td  class='s3 dn'>6.2054171562195
<td  class='s3 dn'>2.8475351333618
<td  class='s3 dn'>2.7391619682312</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>10 year
<td  class='s3'>40.56
<td  class='s3'>7.024
<td  class='s3'>3.062
<td  class='s3'>3.101
<td  class='s3 dn'>40.560017108917
<td  class='s3 dn'>7.0244588851929
<td  class='s3 dn'>3.0623469352722
<td  class='s3 dn'>3.1008150577545</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>11 year
<td  class='s3'>44.4
<td  class='s3'>7.596
<td  class='s3'>3.139
<td  class='s3'>3.13
<td  class='s3 dn'>44.400232791901
<td  class='s3 dn'>7.5963890552521
<td  class='s3 dn'>3.1386148929596
<td  class='s3 dn'>3.1295669078827</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>12 year
<td  class='s3'>48.726
<td  class='s3'>8.184
<td  class='s3'>3.486
<td  class='s3'>3.464
<td  class='s3 dn'>48.725682020187
<td  class='s3 dn'>8.1844367980957
<td  class='s3 dn'>3.4864890575409
<td  class='s3 dn'>3.4639980792999</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>13 year
<td  class='s3'>53.847
<td  class='s3'>8.929
<td  class='s3'>3.656
<td  class='s3'>3.597
<td  class='s3 dn'>53.846739053726
<td  class='s3 dn'>8.9290680885315
<td  class='s3 dn'>3.6557168960571
<td  class='s3 dn'>3.5969679355621</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>14 year
<td  class='s3'>58.199
<td  class='s3'>9.586
<td  class='s3'>4.301
<td  class='s3'>4.24
<td  class='s3 dn'>58.198734998703
<td  class='s3 dn'>9.5861990451813
<td  class='s3 dn'>4.3012638092041
<td  class='s3 dn'>4.240373134613</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>15 year
<td  class='s3'>59.211
<td  class='s3'>10.097
<td  class='s3'>4.368
<td  class='s3'>4.4
<td  class='s3 dn'>59.211224794388
<td  class='s3 dn'>10.097247838974
<td  class='s3 dn'>4.3683612346649
<td  class='s3 dn'>4.4004030227661</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>16 year
<td  class='s3'>64.325
<td  class='s3'>10.826
<td  class='s3'>4.72
<td  class='s3'>4.725
<td  class='s3 dn'>64.325300931931
<td  class='s3 dn'>10.825580835342
<td  class='s3 dn'>4.7198491096497
<td  class='s3 dn'>4.7251362800598</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>17 year
<td  class='s3'>70.181
<td  class='s3'>11.815
<td  class='s3'>5.061
<td  class='s3'>4.898
<td  class='s3 dn'>70.18121099472
<td  class='s3 dn'>11.814760923386
<td  class='s3 dn'>5.0613157749176
<td  class='s3 dn'>4.8978409767151</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>18 year
<td  class='s3'>75.424
<td  class='s3'>12.564
<td  class='s3'>5.237
<td  class='s3'>5.134
<td  class='s3 dn'>75.42404794693
<td  class='s3 dn'>12.564003944397
<td  class='s3 dn'>5.2374458312988
<td  class='s3 dn'>5.1342740058899</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>19 year
<td  class='s3'>80.461
<td  class='s3'>13.304
<td  class='s3'>5.459
<td  class='s3'>5.447
<td  class='s3 dn'>80.4611120224
<td  class='s3 dn'>13.304013967514
<td  class='s3 dn'>5.4592618942261
<td  class='s3 dn'>5.4474551677704</tr>
</table>
<tr>
<td>
<table border=0 cellpadding=0 cellspacing=0 class='tblGenFixed' id='tblMain_1'>
<tr class='rShim'>
<td class='rShim' style='width:0;'>
<td class='rShim' style='width:77px;'>
<td class='rShim' style='width:120px;'>
<td class='rShim' style='width:67px;'>
<td class='rShim' style='width:67px;'>
<td class='rShim' style='width:67px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>20 year
<td  class='s3'>86.625
<td  class='s3'>14.298
<td  class='s3'>5.749
<td  class='s3'>5.704
<td  class='s3 dn'>86.625191688538
<td  class='s3 dn'>14.297990083694
<td  class='s3 dn'>5.7486560344696
<td  class='s3 dn'>5.7037448883057</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>21 year
<td  class='s3'>89.091
<td  class='s3'>14.738
<td  class='s3'>6.08
<td  class='s3'>6.032
<td  class='s3 dn'>89.090814113617
<td  class='s3 dn'>14.73762011528
<td  class='s3 dn'>6.0798182487488
<td  class='s3 dn'>6.0321369171143</tr>
</table>
</table>
<p></center></p>
<p>The reason that Shard-Query performs better is that it turns the OLAP query into something more like OLTP.  Instead of getting one big chunk of data in one query, it runs many smaller queries each requesting significantly less data. On the other hand, MySQL 5.5.7 does not do this on its own.  This is the low hanging fruit I was talking about.  Even though the data is partitioned, MySQL will examine each partition serially.  In the end, this means that things get slower as the query has to examine larger volumes of data.  </p>
<p>Regarding the performance of Shard-Query, this machine has 12 real cores and 12 virtual cores, so we don't see any advantage after increasing the number of workers past 24.   The query becomes CPU bound at that point.  If I needed more performance I could divide the data between two or more shards, or if possible, I could add more CPU cores.  Regardless, even with a single server Shard-Query will perform much better than regular MySQL as the volume of data grows.  Remember that this workload fits entirely in the buffer pool so adding CPUs will help only until we run out of memory bandwidth.</p>
<p><strong>Test #2</strong><br />
My second test involved the next four queries on Vadim's list.  The purpose of this test is to demonstrate that Shard-Query works with GROUP BY and other constructs.</p>
<div class="igBar"><span id="lsql-6"><a href="#" onclick="javascript:showPlainTxt('sql-6'); return false;">PLAIN TEXT</a></span></div>
<div class="syntax_hilite"><span class="langName">SQL:</span>
<div id="sql-6">
<div class="sql">
<ol>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Q1 - <span style="color: #993333; font-weight: bold;">SELECT</span> count<span style="color:#006600; font-weight:bold;">&#40;</span>*<span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color: #993333; font-weight: bold;">FROM</span> ontime.ontime <span style="color: #993333; font-weight: bold;">WHERE</span> FlightDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'1988-01-01'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'1988-12-31'</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Q2 - <span style="color: #993333; font-weight: bold;">SELECT</span> DayOfWeek, count<span style="color:#006600; font-weight:bold;">&#40;</span>*<span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color: #993333; font-weight: bold;">AS</span> c <span style="color: #993333; font-weight: bold;">FROM</span> ontime <span style="color: #993333; font-weight: bold;">WHERE</span> FlightDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'2000-01-01'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'2008-12-31'</span> <span style="color: #993333; font-weight: bold;">GROUP</span> <span style="color: #993333; font-weight: bold;">BY</span> DayOfWeek <span style="color: #993333; font-weight: bold;">ORDER</span> <span style="color: #993333; font-weight: bold;">BY</span> c <span style="color: #993333; font-weight: bold;">DESC</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Q3 - <span style="color: #993333; font-weight: bold;">SELECT</span> Origin, count<span style="color:#006600; font-weight:bold;">&#40;</span>*<span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color: #993333; font-weight: bold;">AS</span> c <span style="color: #993333; font-weight: bold;">FROM</span> ontime <span style="color: #993333; font-weight: bold;">WHERE</span> DepDelay&gt;<span style="color: #cc66cc;color:#800000;">10</span> <span style="color: #993333; font-weight: bold;">AND</span> FlightDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'2000-01-01'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'2008-12-31'</span>&nbsp; <span style="color: #993333; font-weight: bold;">GROUP</span> <span style="color: #993333; font-weight: bold;">BY</span> Origin <span style="color: #993333; font-weight: bold;">ORDER</span> <span style="color: #993333; font-weight: bold;">BY</span> c <span style="color: #993333; font-weight: bold;">DESC</span> <span style="color: #993333; font-weight: bold;">LIMIT</span> <span style="color: #cc66cc;color:#800000;">10</span>;</div>
</li>
<li style="font-weight: bold;color:#26536A;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">&nbsp;</div>
</li>
<li style="font-family: 'Courier New', Courier, monospace; color: black; font-weight: normal; font-style: normal;color:#3A6A8B;">
<div style="font-family: 'Courier New', Courier, monospace; font-weight: normal;">Q4 - <span style="color: #993333; font-weight: bold;">SELECT</span> carrier, count<span style="color:#006600; font-weight:bold;">&#40;</span>*<span style="color:#006600; font-weight:bold;">&#41;</span> <span style="color: #993333; font-weight: bold;">FROM</span> ontime <span style="color: #993333; font-weight: bold;">WHERE</span> DepDelay&gt;<span style="color: #cc66cc;color:#800000;">10</span> <span style="color: #993333; font-weight: bold;">AND</span> FlightDate <span style="color: #993333; font-weight: bold;">BETWEEN</span> <span style="color: #ff0000;">'2007-01-01'</span> <span style="color: #993333; font-weight: bold;">AND</span> <span style="color: #ff0000;">'2007-12-31'</span> <span style="color: #993333; font-weight: bold;">GROUP</span> <span style="color: #993333; font-weight: bold;">BY</span> carrier <span style="color: #993333; font-weight: bold;">ORDER</span> <span style="color: #993333; font-weight: bold;">BY</span> <span style="color: #cc66cc;color:#800000;">2</span> <span style="color: #993333; font-weight: bold;">DESC</span>; </div>
</li>
</ol>
</div>
</div>
</div>
<p></p>
<p><center><br />
<a href="http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/shard_query_test2.png"><img src="http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/shard_query_test2.png" alt="Comparing the performance of four queries at 16 workers" title="shard_query_test#2" width="600" height="371" class="aligncenter size-full wp-image-3950" /></a><br />
</center><br />
<center><br />
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/><meta name='lsq' content='33'/><meta name='trixrows' content='101'/><meta name='trixr1' content='0'/><meta name='trixr2' content='5'/><meta name='trixdiv' content='20'/><meta name='trixcnt' content='1'/><meta name='trixlast' content='5'/>
<link rel=stylesheet href="//spreadsheets.google.com/client/css/552456475-trix_main-ssl.css" type="text/css">
<style>.tblGenFixed td {padding:0 3px;overflow:hidden;white-space:normal;letter-spacing:0;word-spacing:0;background-color:#fff;z-index:1;border-top:0px none;border-left:0px none;border-bottom:1px solid #CCC;border-right:1px solid #CCC;} .dn {display:none} .tblGenFixed td.s0 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:left;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-top:1px solid #CCC;border-right:1px solid #CCC;border-bottom:1px solid #CCC;border-left:1px solid #CCC;} .tblGenFixed td.s2 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:right;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-right:1px solid #CCC;border-bottom:1px solid #CCC;border-left:1px solid #CCC;} .tblGenFixed td.s1 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:left;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-top:1px solid #CCC;border-right:1px solid #CCC;border-bottom:1px solid #CCC;} .tblGenFixed td.s3 {background-color:white;font-family:arial,sans,sans-serif;font-size:100.0%;font-weight:normal;font-style:normal;color:#000000;text-decoration:none;text-align:right;vertical-align:bottom;white-space:normal;overflow:hidden;text-indent:0px;padding-left:3px;border-right:1px solid #CCC;border-bottom:1px solid #CCC;} </style>
<p></head><body style='border:0px;margin:0px'><br />
<table border=0 cellpadding=0 cellspacing=0 id='tblMain'>
<tr>
<td>
<table border=0 cellpadding=0 cellspacing=0 class='tblGenFixed' id='tblMain_0'>
<tr class='rShim'>
<td class='rShim' style='width:0;'>
<td class='rShim' style='width:120px;'>
<td class='rShim' style='width:120px;'>
<td class='rShim' style='width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<td class='rShim hdn' style='display:none;width:120px;'>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s0'>Query Number
<td  class='s1'>No shard-query
<td  class='s1'>16 workers
<td  class='s1 dn'>No shard-query
<td  class='s1 dn'>16 workers</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>1
<td  class='s3'>4.661
<td  class='s3'>0.86
<td  class='s3 dn'>4.660569190979
<td  class='s3 dn'>0.8596088886261</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>2
<td  class='s3'>84.362
<td  class='s3'>19.355
<td  class='s3 dn'>84.362482070923
<td  class='s3 dn'>19.355075120926</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>3
<td  class='s3'>128.603
<td  class='s3'>33.271
<td  class='s3 dn'>128.60283708572
<td  class='s3 dn'>33.270862102509</tr>
<tr>
<td class=hd>
<p style='height:16px;'>.</td>
<td  class='s2'>4
<td  class='s3'>8.686
<td  class='s3'>1.929
<td  class='s3 dn'>8.68621301651
<td  class='s3 dn'>1.9287579059601</tr>
</table>
</table>
<p></center><br />
As you can see, each of the queries runs significantly faster than just running the SQL via MySQL.  </p>
<p>The remainder of Vadim's queries use subqueries in the FROM clause, which Shard-Query does not yet add parallelism to.  I plan to add support for those queries though, and I'll post a follow-up when I do.<br />
<code><a name"full"></a>-- Full Disclosure --<br />
<a href='http://www.mysqlperformanceblog.com/wp-content/uploads/2010/11/full_disclosure_cisco_shardquery_benchmark.txt'>This is a text file containing the information.</a></p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Justin Swanhart |
      <a href="http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/#comments">12 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/&amp;title=Shard-Query adds parallelism to queries" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/&amp;title=Shard-Query adds parallelism to queries" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/&amp;title=Shard-Query adds parallelism to queries" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/&amp;T=Shard-Query adds parallelism to queries" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/&amp;title=Shard-Query adds parallelism to queries" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:92:"http://www.mysqlperformanceblog.com/2010/11/15/shard-query-adds-parallelism-to-queries/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:2:"12";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:8;a:6:{s:4:"data";s:41:"
		
		
		
		
		
				

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:43:"Advanced index analysis with mk-index-usage";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:91:"http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:100:"http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Thu, 11 Nov 2010 18:50:25 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:1:{i:0;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=3922";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:327:"The new release of Maatkit has a useful feature in mk-index-usage to help you determine how indexes are used in more flexible ways.  The default report just prints out ALTER statements for removing unused indexes, which is nice, but it's often helpful to ask more sophisticated questions about index usage.  I'll use this [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:14:"Baron Schwartz";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:8683:"<p>The new release of <a href="http://code.google.com/p/maatkit/">Maatkit</a> has a useful feature in mk-index-usage to help you determine how indexes are used in more flexible ways.  The default report just prints out ALTER statements for removing unused indexes, which is nice, but it's often helpful to ask more sophisticated questions about index usage.  I'll use this blog's queries and indexes as an example.</p>
<p>The new feature lets you store the index usage into tables in a database, so you can query them with SQL.  I logged all queries to the blog for a little while, and then secure-copied the query log to my laptop, which is across the continent.  I used a variation on <a href="http://mysqlsandbox.net/">MySQL Sandbox</a> to set up a little throw-away MySQL instance -- that took ten seconds.  And then I set up an SSH tunnel from my laptop to the MySQL Performance Blog server -- another 30 seconds.</p>
<p>Now I'm set up: I can crunch the log locally, make it connect over the SSH tunnel to query EXPLAIN and find out the index usage on the remote server, and store the results in my MySQL sandbox instance.  The new option is --save-results-database.  The full mk-index-usage command looks like this:</p>
<p><code>
<pre>mk-index-usage -h 127.0.0.1 -P 9999 -p XXXX slow_query.log \
  --save-results-database h=127.0.0.1,P=12345,u=msandbox,p=msandbox,D=index_usage \
  --create-save-results-database
</pre>
<p></code></p>
<p>After that finishes, the 'index_usage' database contains several tables:</p>
<p><code>
<pre>
mysql> show tables;
+-----------------------+
| Tables_in_index_usage |
+-----------------------+
| index_alternatives    |
| index_usage           |
| indexes               |
| queries               |
| tables                |
+-----------------------+
</pre>
<p></code></p>
<p>Now let's run some queries!  From the <a href="http://www.maatkit.org/doc/mk-index-usage.html#save_results_database">documentation</a>, you can copy-paste the examples.  Let's start with this one: which queries sometimes use different indexes, and what fraction of the time is each index chosen?</p>
<p><code>
<pre>SELECT  iu.query_id, CONCAT_WS('.', iu.db, iu.tbl, iu.idx) AS idx,
    variations, iu.cnt, iu.cnt / total_cnt * 100 AS pct
 FROM index_usage AS iu
    INNER JOIN (
       SELECT query_id, db, tbl, SUM(cnt) AS total_cnt,
         COUNT(*) AS variations
       FROM index_usage
       GROUP BY query_id, db, tbl
       HAVING COUNT(*) > 1
    ) AS qv USING(query_id, db, tbl);
+----------------------+--------------------------------------------------------------+------------+-----+---------+
| query_id             | idx                                                          | variations | cnt | pct     |
+----------------------+--------------------------------------------------------------+------------+-----+---------+
|  1262633894049058504 | mpb_wordpress.wp_posts.post_status                           |          2 |  35 | 70.0000 |
|  1262633894049058504 | mpb_wordpress.wp_posts.type_status_date                      |          2 |  15 | 30.0000 |
|  7675136724153707161 | mpb_wordpress.wp_comments.comment_approved                   |          2 |  18 |  2.4129 |
|  7675136724153707161 | mpb_wordpress.wp_comments.comment_post_ID                    |          2 | 728 | 97.5871 |
... snip ...
14 rows in set (0.00 sec)
</pre>
<p></code></p>
<p>Here's how to read this -- the first row says that query 1262633894049058504 has two variations.  One variation uses the mpb_wordpress.wp_posts.post_status index, 70% of the time in fact.  The next variation is in row 2, the same query, which uses an index on post_status the other 30% of the time.  If you look a few rows down, you can see that query 7675136724153707161 has a much more skewed index usage: 2.4% of the time it uses one index, and the rest of the time it uses another.  These kinds of variations in query execution plans are important.  You don't want a small fraction of queries to have very different performance, in general -- you want consistent performance.  Maybe the performance IS consistent, we don't know that from looking here, but we know that there is something worth looking into.</p>
<p>What is query 7675136724153707161, anyway?</p>
<p><code>
<pre>mysql> select * from queries where query_id = 7675136724153707161\G
*************************** 1. row ***************************
   query_id: 7675136724153707161
fingerprint: select * from wp_comments where comment_post_id = ? and comment_type not regexp ? and comment_approved = ?
     sample: SELECT * FROM wp_comments WHERE comment_post_ID = 2257 AND
comment_type NOT REGEXP '^(trackback|pingback)$' AND comment_approved = '1'
1 row in set (0.00 sec)
</pre>
<p></code></p>
<p>How about another question: which indexes have lots of alternatives, i.e. are chosen instead of other indexes, and for what queries?  This time I'll add LIMIT 2 to the query, because there are lots of them:</p>
<p><code>
<pre>mysql>  SELECT CONCAT_WS('.', db, tbl, idx) AS idx,
    ->     GROUP_CONCAT(alt_idx) AS alternatives,
    ->     GROUP_CONCAT(DISTINCT query_id) AS queries, SUM(cnt) AS cnt
    ->  FROM index_alternatives
    ->  GROUP BY db, tbl, idx
    ->  HAVING COUNT(*) > 1 limit 2;
+------------------------------------+---------------------------------------------------+------------------------------------------+------+
| idx                                | alternatives                                      | queries                                  | cnt  |
+------------------------------------+---------------------------------------------------+------------------------------------------+------+
| mpb_forum.f.PRIMARY                | fud26_forum_i_c,fud26_forum_i_c,fud26_forum_i_lpi | 6095451542512376951,11680437198542055892 |   20 |
| mpb_forum.fud26_msg.fud26_msg_i_ta | PRIMARY,fud26_msg_i_a                             | 5971938384822841613                      |    2 |
+------------------------------------+---------------------------------------------------+------------------------------------------+------+
</pre>
<p></code></p>
<p>So the primary key on a table in the forum database is favored over a couple of other indexes, for queries 6095451542512376951 and 11680437198542055892.</p>
<p>I think you can see how this goes -- you can query these tables any way you want.  The documentation includes a number of other canned queries you can run.  I found a few things that I want to improve about the canned queries while writing this blog post.  If you have suggestions, please post in the comments or file issues at the Maatkit bug tracker.  And enjoy learning how your indexes are used!</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Baron Schwartz |
      <a href="http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/#comments">2 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/&amp;title=Advanced index analysis with mk-index-usage" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/&amp;title=Advanced index analysis with mk-index-usage" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/&amp;title=Advanced index analysis with mk-index-usage" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/&amp;T=Advanced index analysis with mk-index-usage" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/&amp;title=Advanced index analysis with mk-index-usage" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:96:"http://www.mysqlperformanceblog.com/2010/11/11/advanced-index-analysis-with-mk-index-usage/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"2";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:9;a:6:{s:4:"data";s:65:"
		
		
		
		
		
				
		
		
		
		
		
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:39:"Lost innodb tables, xfs and binary grep";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:86:"http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:95:"http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 09 Nov 2010 10:26:26 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:9:{i:0;a:5:{s:4:"data";s:7:"Backups";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:6:"Innodb";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:5:"mysql";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:8:"recovery";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:4;a:5:{s:4:"data";s:4:"tips";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:5;a:5:{s:4:"data";s:5:"tools";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:6;a:5:{s:4:"data";s:5:"bgrep";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:7;a:5:{s:4:"data";s:4:"grep";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:8;a:5:{s:4:"data";s:3:"xfs";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:43:"http://www.mysqlperformanceblog.com/?p=3906";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:305:"Before I start a story about the data recovery case I worked on yesterday, here's a quick tip - having a database backup does not mean you can restore from it. Always verify your backup can be used to restore the database! If not automatically, do this manually, at least once a month. No, seriously [...]";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:19:"Aurimas Mikalauskas";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:7657:"<p>Before I start a story about the <a href="http://www.percona.com/consulting/data-recovery/">data recovery</a> case I worked on yesterday, here's a quick tip - having a <strong>database backup does not mean you can restore from it</strong>. Always verify your backup can be used to restore the database! If not automatically, do this manually, at least once a month. No, seriously - in most of the recovery cases I worked on, customers did have some sort of backup, but it just wasn't working, complete and what not. Someone set it up and never bothered to check if it still works after a while.</p>
<p>Anyway, this post is not really about the backups but rather about few interesting things I learned during last recovery case.</p>
<p>First, some facts about the system and how data was lost:</p>
<ul>
<li> MySQL had a dedicated partition on XFS file system </li>
<li> Server was running innodb_file_per_table </li>
<li> There was a production master and two slaves, all had same setting </li>
<li> Developer accidentally ran DROP DATABASE X on the wrong machine (production master) </li>
<li> All slaves followed and dropped their copy of the data </li>
<li> The important tables were all InnoDB </li>
<li> Having a backup, customer has first attempted to restore from backup on the production master </li>
</ul>
<p>Luckily (or rather, unfortunately) backup only had table definitions but not the data so no data was written to file system. Mind however that restoring a backup could have been fatal if it would have written some junk data as that would have overwritten the deleted files. Now, here's what I learned while working on this case:</p>
<p><strong>Recovering from XFS is possible.</strong> Just a month ago we had a team meeting in Mallorca where we went through various data loss scenarios. One of them was deleted files on xfs - we all agreed on few things:</p>
<ul>
<li> recovering files from xfs is hard, if at all possible </li>
<li> we had no recovery cases on xfs, most likely because: </li>
<li> whoever is using xfs, is smart enough to have backups set up properly </li>
</ul>
<p>Now I'm not picking on the customer or anything - indeed they did have a backup set up, it's just that some (most important) tables weren't backed up. We did not try any of the file recovery tools for xfs - apparently they are all targeting specific file types and sure enough InnoDB is not one of the supported files. What we did is we simply ran <a href="https://launchpad.net/percona-innodb-recovery-tool">page_parser</a> on the (already) unmounted file system treating it as a raw device. I was surprised how amazingly simple and fast it was (did you know that latest version of page_parser identifies pages by infimum and supremum records?) - 10G partition was scanned in like 5 minutes and all 4G of innodb pages were successfully written to a separate partition. That's the easy part though - you run page parser, wait and see what you get.</p>
<p>If InnoDB Data Dictionary was not overwritten by an attempt to restore from the backup, actually second part would've been quite easy too, but it was so I could no longer identify correct PK id for specific tables by just mapping data dictionary table records to index records. Instead I had to <em>grep</em> for specific character sequences against all pages. Note however that only works for text in uncompressed text columns (varchar, char, text) but what if tables don't have any text columns at all? Then, you read further.</p>
<p><strong>GNU grep won't match binary strings.</strong> This isn't new, I kind of knew grep couldn't look for binary "junk", but I really needed it to. Why? Well, here's few of the scenarios we've gone through yesterday:</p>
<p>1. There was this rather big table with integer and enum columns only, where we knew a rather unique PK, well something like 837492636 so we needed a way to find pages that match it. InnoDB would internally store integers in 4-bytes rather than 10 bytes if it were stored as a sequence of characters, so "grep -r 837492636 /dir" would not have worked.</p>
<p>2. There was another table, a small one with 4 smallint columns where all we could match on was a sequence of numbers from a single record - customer knew that there was at least one row with the following sequence: 7, 3, 7, 8. Matching by any of the numbers would be insane as it would match all of the pages while matching on numbers as a sequence of characters would not work for many reasons.</p>
<p>This is where I found <a href="http://debugmo.de/2009/04/bgrep-a-binary-grep/">bgrep</a> which was exactly the tool for the task. In the case number one, I have just converted number 837492636 to it's binary representation 0x31EB1F9C and ran "bgrep 31EB1F9C /dir" - there were only like 10 other matches across the 4 gigabytes of pages, some of them probably from the secondary pages, but when you only have that many pages to check it's really simple.</p>
<p>Second case seemed somewhat complicated, but it really wasn't - all of the columns were fixed size - 2bytes each, so the thing we had to look for was this sequence: 0007000300070008. I was expecting a lot of mismatches but in fact I ended up with only one match pointing exactly to the right page and so the right index id.</p>
<p>The other thing I would note about bgrep - it was so much faster than matching text using grep, so if you happen to have a lot of data to scan and you have to choose between matching text and number, matching a number using bgrep may work much better.</p>
<p>We are considering shipping bgrep as part of percona recovery toolset, with some additional converters so we can match against various date/time columns as well.</p>
    <hr noshade style="margin:0;height:1px" />
    <p>Entry posted by Aurimas Mikalauskas |
      <a href="http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/#comments">10 comments</a></p>
    <p>Add to: <a href="http://del.icio.us/post?url=http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/&amp;title=Lost innodb tables, xfs and binary grep" title="Bookmark this post on del.icio.us"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/delicious.png" alt="delicious" /></a> | <a href="http://digg.com/submit?phase=2&amp;url=http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/&amp;title=Lost innodb tables, xfs and binary grep" title="Digg this post on Digg.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/digg.png" alt="digg" /></a> | <a href="http://reddit.com/submit?url=http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/&amp;title=Lost innodb tables, xfs and binary grep" title="Submit this post on reddit.com"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/reddit.png" alt="reddit" /></a> | <a href="http://www.netscape.com/submit/?U=http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/&amp;T=Lost innodb tables, xfs and binary grep" title="Vote for this article on Netscape"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/netscape.gif" alt="netscape" /></a> | <a href="http://www.google.com/bookmarks/mark?op=add&amp;bkmk=http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/&amp;title=Lost innodb tables, xfs and binary grep" title="Add to Google Bookmarks"><img src="http://www.mysqlperformanceblog.com/wp-content/themes/boxy-but-gold/images/google.png" alt="Google Bookmarks" /></a></p>";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:91:"http://www.mysqlperformanceblog.com/2010/11/09/lost-innodb-tables-xfs-and-binary-grep/feed/";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:2:"10";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}}s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:3:{s:4:"href";s:41:"http://www.mysqlperformanceblog.com/feed/";s:3:"rel";s:4:"self";s:4:"type";s:19:"application/rss+xml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:44:"http://purl.org/rss/1.0/modules/syndication/";a:2:{s:12:"updatePeriod";a:1:{i:0;a:5:{s:4:"data";s:6:"hourly";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:15:"updateFrequency";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}}}}}}}s:7:"headers";a:10:{s:4:"date";s:29:"Thu, 25 Nov 2010 20:50:02 GMT";s:6:"server";s:6:"Apache";s:13:"last-modified";s:29:"Tue, 23 Nov 2010 16:48:09 GMT";s:10:"x-pingback";s:46:"http://www.mysqlperformanceblog.com/xmlrpc.php";s:4:"etag";s:32:"38b4c7f7576bbdd8e96e33e462572229";s:4:"vary";s:15:"Accept-Encoding";s:16:"content-encoding";s:4:"gzip";s:14:"content-length";s:5:"21363";s:12:"content-type";s:24:"text/html; charset=UTF-8";s:10:"connection";s:5:"close";}s:5:"build";s:14:"20070715235228";}