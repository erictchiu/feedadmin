a:3:{s:5:"child";a:1:{s:0:"";a:1:{s:3:"rss";a:1:{i:0;a:6:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:1:{s:7:"version";s:3:"2.0";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:1:{s:0:"";a:1:{s:7:"channel";a:1:{i:0;a:6:{s:4:"data";s:50:"
	
	
	
	
	
	
	
	
	
		
		
		
		
		
		
		
		
		
		
	";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:3:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:22:"youdidwhatwithtsql.com";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:33:"http://www.youdidwhatwithtsql.com";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:29:"making DBAs everywhere curse!";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:13:"lastBuildDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Thu, 11 Nov 2010 20:29:41 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"language";a:1:{i:0;a:5:{s:4:"data";s:2:"en";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:9:"generator";a:1:{i:0;a:5:{s:4:"data";s:29:"http://wordpress.org/?v=3.0.1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"item";a:10:{i:0;a:6:{s:4:"data";s:41:"
		
		
		
		
		
				

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:32:"Schedule a Windows server reboot";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:70:"http://www.youdidwhatwithtsql.com/schedule-a-windows-server-reboot/905";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:79:"http://www.youdidwhatwithtsql.com/schedule-a-windows-server-reboot/905#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Thu, 11 Nov 2010 20:25:34 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:1:{i:0;a:5:{s:4:"data";s:3:"DBA";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:70:"http://www.youdidwhatwithtsql.com/schedule-a-windows-server-reboot/905";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:521:"Just a quick one today as I’m always forgetting how to do this! I occasionally have to schedule server reboots to happen in the middle of the night. This is easily achieved by using the AT command in a command prompt window. The following example will schedule a server reboot for 3AM as a one-off [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/schedule-a-windows-server-reboot/905">Schedule a Windows server reboot</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:2146:"<p>Just a quick one today as I’m always forgetting how to do this! I occasionally have to schedule server reboots to happen in the middle of the night. This is easily achieved by using the <a href="http://support.microsoft.com/kb/313565" target="_blank">AT command</a> in a command prompt window. The following example will schedule a server reboot for 3AM as a one-off job.</p>
<pre>AT 03:00 shutdown /r</pre>
<p>If all goes well you should get a message back like “Added a new job with Job ID = 1.” If you get an “access is denied” error then you need to run the console as Administrator. The jobs created this way can be viewed using the <a title="Windows 7 Task Scheduler" href="http://en.wikipedia.org/wiki/Task_Scheduler" target="_blank">Task Scheduler</a>.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/task_scheduler.png"><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="task_scheduler" border="0" alt="task scheduler thumb Schedule a Windows server reboot" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/task_scheduler_thumb.png" width="644" height="371" /></a></p>
<p><map name='google_ad_map_905_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/905?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_905_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=905&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fschedule-a-windows-server-reboot%2F905' title="Schedule a Windows server reboot" alt=" Schedule a Windows server reboot" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/schedule-a-windows-server-reboot/905">Schedule a Windows server reboot</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:75:"http://www.youdidwhatwithtsql.com/schedule-a-windows-server-reboot/905/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:1;a:6:{s:4:"data";s:50:"
		
		
		
		
		
				
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:39:"Why didn’t I know this SSMS Shortcut?";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:73:"http://www.youdidwhatwithtsql.com/why-didnt-i-know-this-ssms-shortcut/902";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:82:"http://www.youdidwhatwithtsql.com/why-didnt-i-know-this-ssms-shortcut/902#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Fri, 05 Nov 2010 21:25:22 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:4:{i:0;a:5:{s:4:"data";s:3:"DBA";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:10:"SQL Server";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:28:"SQL Server Management Studio";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:4:"SSMS";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:73:"http://www.youdidwhatwithtsql.com/why-didnt-i-know-this-ssms-shortcut/902";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:533:"I was in two minds about whether to blog about this as I’m sure many people know this already! What the hell! I’m not embarrassed to admit I don’t know everything. Even the most casual user of SSMS knows that you can drag any database, table or column from the object explorer to the editor. [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/why-didnt-i-know-this-ssms-shortcut/902">Why didn&rsquo;t I know this SSMS Shortcut?</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:3883:"<p>I was in two minds about whether to blog about this as I’m sure many people know this already! What the hell! I’m not embarrassed to admit I don’t know everything.</p>
<p>Even the most casual user of <a title="SQL Server Management Studio" href="http://en.wikipedia.org/wiki/SQL_Server_Management_Studio" target="_blank">SSMS</a> knows that you can drag any database, table or column from the object explorer to the editor.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/drag_column_sql_server_management_studio_ssms.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="drag_column_sql_server_management_studio_ssms" border="0" alt="drag column sql server management studio ssms thumb Why didn&rsquo;t I know this SSMS Shortcut?" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/drag_column_sql_server_management_studio_ssms_thumb.png" width="424" height="484" /></a></p>
<p>The object name that is dragged into the editor will get inserted into your script. A simple and handy timesaver!</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/sql_server_management_studio_editor.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="sql_server_management_studio_editor" border="0" alt="sql server management studio editor thumb Why didn&rsquo;t I know this SSMS Shortcut?" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/sql_server_management_studio_editor_thumb.png" width="644" height="179" /></a></p>
<p>But did you know the same applies to the <strong>columns</strong> folder under each table? Drag and drop the columns folder into the editor and all the column names, from the relevant table, will be inserted into your script.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/sql_server_management_studio_editor_all_columns.png"><img style="background-image: none; border-bottom: 0px; border-left: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top: 0px; border-right: 0px; padding-top: 0px" title="sql_server_management_studio_editor_all_columns" border="0" alt="sql server management studio editor all columns thumb Why didn&rsquo;t I know this SSMS Shortcut?" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/11/sql_server_management_studio_editor_all_columns_thumb.png" width="644" height="94" /></a></p>
<p>I dread to think of the time I’ve wasted dragging each column individually! Now there’s another reason not to use <strong>SELECT *</strong> in your scripts! Do you know of any more <a title="SQL Server Management Studio" href="http://en.wikipedia.org/wiki/SQL_Server_Management_Studio" target="_blank">SSMS</a> timesaving gems?</p>
<p><map name='google_ad_map_902_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/902?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_902_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=902&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fwhy-didnt-i-know-this-ssms-shortcut%2F902' title="Why didn&rsquo;t I know this SSMS Shortcut?" alt=" Why didn&rsquo;t I know this SSMS Shortcut?" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/why-didnt-i-know-this-ssms-shortcut/902">Why didn&rsquo;t I know this SSMS Shortcut?</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:78:"http://www.youdidwhatwithtsql.com/why-didnt-i-know-this-ssms-shortcut/902/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:2;a:6:{s:4:"data";s:41:"
		
		
		
		
		
				

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:18:"Beware of the BIT!";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:48:"http://www.youdidwhatwithtsql.com/beware-bit/891";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:57:"http://www.youdidwhatwithtsql.com/beware-bit/891#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Fri, 29 Oct 2010 10:47:47 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:1:{i:0;a:5:{s:4:"data";s:5:"T-SQL";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:40:"http://www.youdidwhatwithtsql.com/?p=891";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:487:"I&#8217;ve been spending the past week or so changing a colleagues scripts into SSRS reports so we can automate things a bit better. During some QA checks I noticed that I was coming out with higher counts on one section of the report. Much to my frustration the two queries looked identical and I had [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/beware-bit/891">Beware of the BIT!</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:3845:"<p>I&#8217;ve been spending the past week or so changing a colleagues scripts into <a title="SQL Server Reporting Services" href="http://msdn.microsoft.com/en-us/library/ms159106.aspx" target="_blank">SSRS</a> reports so we can automate things a bit better. During some <a title="Quality Assurance" href="http://en.wikipedia.org/wiki/Quality_assurance" target="_blank">QA</a> checks I noticed that I was coming out with higher counts on one section of the report.</p>
<p>Much to my frustration the two queries looked identical and I had no explanation as to why the counts were different.  Both queries were pointing at the same database, using the same tables, using the same variable and variable values. How was this possible?</p>
<p>It was all down to a single variable being declared as a <a title="SQL Server BIT Data Type" href="http://msdn.microsoft.com/en-us/library/ms177603.aspx" target="_blank">BIT</a> when it should have been a <a title="SQL Server TINYINT Data Type" href="http://msdn.microsoft.com/en-us/library/ms187745.aspx" target="_blank">TINYINT</a>. The below TSQL demonstrates this issue&#8230;</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p891code2'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p8912"><td class="code" id="p891code2"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">DECLARE</span> @<span style="color: #0000FF;">bit</span> <span style="color: #0000FF;">BIT</span>;
<span style="color: #0000FF;">SET</span> @<span style="color: #0000FF;">bit</span> <span style="color: #808080;">=</span> <span style="color: #000;">2</span>;
<span style="color: #0000FF;">SELECT</span> @<span style="color: #0000FF;">bit</span> <span style="color: #0000FF;">AS</span> whoops;</pre></td></tr></table></div>

<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/10/whoops.png"><img class="alignnone size-full wp-image-892" title="whoops" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/10/whoops.png" alt="whoops Beware of the BIT!" width="162" height="71" /></a></p>
<p>That&#8217;s right, no overflow error, it just happily truncates the value down to one! I&#8217;ve blogged about a <a title="Integer arithmetic in SQL" href="http://www.youdidwhatwithtsql.com/unsigned-integer-arithmetic-in-sql/794" target="_self">similar issue</a> before but <a href="http://www.mysql.com/">MySQL</a> was the badly behaved one in this situation.  I&#8217;m guessing here that the BIT variable was based on a column that was, at one time, a BIT. But as the system evolved the column changed into a TINYINT but reports weren&#8217;t updated.  I&#8217;m unsure if there&#8217;s a way to make SQL Server error on this but it&#8217;s certainly something to keep an eye on!</p>
<p><map name='google_ad_map_891_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/891?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_891_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=891&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fbeware-bit%2F891' title="Beware of the BIT!" alt=" Beware of the BIT!" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/beware-bit/891">Beware of the BIT!</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:53:"http://www.youdidwhatwithtsql.com/beware-bit/891/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:3;a:6:{s:4:"data";s:47:"
		
		
		
		
		
				
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:26:"Send email with Powershell";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:64:"http://www.youdidwhatwithtsql.com/send-email-with-powershell/889";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:73:"http://www.youdidwhatwithtsql.com/send-email-with-powershell/889#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Wed, 27 Oct 2010 19:03:18 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:3:{i:0;a:5:{s:4:"data";s:10:"Powershell";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:5:"Email";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:20:"Powershell Scripting";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:40:"http://www.youdidwhatwithtsql.com/?p=889";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:605:"There’s two methods I often use for sending email in my Powershell scripts. The first uses the Send-MailMessage cmdlet and the second resorts to using the .Net Framework. Why do I use two methods? Well…. ?View Code POWERSHELLSend-MailMessage -To 'me@here.com' -From 'sender@here.com' -Subject 'Test Message' -Body 'This is a test message.' -SmtpServer 'smtp.server.com'; The Send-MailMessage [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/send-email-with-powershell/889">Send email with Powershell</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:4533:"<p>There’s two methods I often use for sending email in my <a href="http://en.wikipedia.org/wiki/Windows_PowerShell" target="_blank">Powershell</a> scripts. The first uses the <a href="http://technet.microsoft.com/en-us/library/dd347693.aspx" target="_blank">Send-MailMessage</a> cmdlet and the second resorts to using the .Net Framework. Why do I use two methods? Well….</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p889code5'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p8895"><td class="code" id="p889code5"><pre class="powershell" style="font-family:monospace;">Send<span style="color: pink;">-</span>MailMessage <span style="color: pink;">-</span>To <span style="color: #800000;">'me@here.com'</span> <span style="color: pink;">-</span>From <span style="color: #800000;">'sender@here.com'</span> <span style="color: pink;">-</span>Subject <span style="color: #800000;">'Test Message'</span> <span style="color: #008080; font-style: italic;">-Body</span> <span style="color: #800000;">'This is a test message.'</span> <span style="color: pink;">-</span>SmtpServer <span style="color: #800000;">'smtp.server.com'</span>;</pre></td></tr></table></div>

<p>The <a href="http://technet.microsoft.com/en-us/library/dd347693.aspx" target="_blank">Send-MailMessage</a> cmdlet is powerful and easy to use but it’s lacking one important switch. If you’re using a smtp server on a port other than the default (25) then you cannot use this cmdlet to send emails. There’s no switch available to change the port used to send email. Here’s how I get around it.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p889code6'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p8896"><td class="code" id="p889code6"><pre class="powershell" style="font-family:monospace;"><span style="color: #800080;">$smtpClient</span> <span style="color: pink;">=</span> <span style="color: #008080; font-weight: bold;">New-Object</span> System.Net.Mail.SmtpClient;
<span style="color: #800080;">$smtpClient</span>.Host <span style="color: pink;">=</span> <span style="color: #800000;">'smtp.server.com'</span>;
<span style="color: #800080;">$smtpClient</span>.Port <span style="color: pink;">=</span> <span style="color: #804000;">8025</span>;
<span style="color: #800080;">$smtpClient</span>.Send<span style="color: #000000;">&#40;</span><span style="color: #800000;">'email@email.com'</span><span style="color: pink;">,</span><span style="color: #800000;">'email@email.com'</span><span style="color: pink;">,</span><span style="color: #800000;">'Test Message'</span><span style="color: pink;">,</span> <span style="color: #800000;">'This is a test message.'</span><span style="color: #000000;">&#41;</span>;</pre></td></tr></table></div>

<p>Powershell’s ability to hook into the .Net framework allows us to get around any limitation existing in the built in <a href="http://msdn.microsoft.com/en-us/library/ms714395(VS.85).aspx" target="_blank">cmdlets</a>. However, I’m still rooting for a –Port switch in the next version of Powershell!</p>
<p><map name='google_ad_map_889_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/889?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_889_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=889&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fsend-email-with-powershell%2F889' title="Send email with Powershell" alt=" Send email with Powershell" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/send-email-with-powershell/889">Send email with Powershell</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:69:"http://www.youdidwhatwithtsql.com/send-email-with-powershell/889/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:4;a:6:{s:4:"data";s:47:"
		
		
		
		
		
				
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:38:"Tweet-SQL: Storing searches in a table";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:75:"http://www.youdidwhatwithtsql.com/tweet-sql-storing-searches-in-a-table/888";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:84:"http://www.youdidwhatwithtsql.com/tweet-sql-storing-searches-in-a-table/888#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Sat, 23 Oct 2010 15:05:28 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:3:{i:0;a:5:{s:4:"data";s:8:"Software";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:9:"Tweet-SQL";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:14:"Twitter search";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:75:"http://www.youdidwhatwithtsql.com/tweet-sql-storing-searches-in-a-table/888";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:574:"A Tweet-SQL user emailed me recently about how to store results from the tweet_src_search procedure in a table. Twitter returns an atom feed for search requests so you have to handle this slightly differently compared to other Tweet-SQL procedures. Here’s a quick walk-through of how we can get Twitter search results into a database table [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/tweet-sql-storing-searches-in-a-table/888">Tweet-SQL: Storing searches in a table</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:11700:"<p>A <a href="http://www.tweet-sql.com" target="_blank">Tweet-SQL</a> user emailed me recently about how to store results from the tweet_src_search procedure in a table. <a href="http://twitter.com" target="_blank">Twitter</a> returns an <a href="http://search.cpan.org/~miyagawa/XML-Atom-0.37/lib/XML/Atom.pm" target="_blank">atom</a> feed for search requests so you have to handle this slightly differently compared to other <a href="http://www.tweet-sql.com" target="_blank">Tweet-SQL</a> procedures. </p>
<p>Here’s a quick walk-through of how we can get Twitter search results into a database table using <a href="http://www.tweet-sql.com" target="_blank">Tweet-SQL</a>. First create a table to hold the tweets.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p888code10'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p88810"><td class="code" id="p888code10"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">CREATE</span> <span style="color: #0000FF;">TABLE</span> dbo.<span style="color: #202020;">TwitterSearchResults</span>
<span style="color: #808080;">&#40;</span>
	Id <span style="color: #0000FF;">INTEGER</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span> <span style="color: #0000FF;">IDENTITY</span><span style="color: #808080;">&#40;</span><span style="color: #000;">1</span>,<span style="color: #000;">1</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">PRIMARY</span> <span style="color: #0000FF;">KEY</span> <span style="color: #0000FF;">CLUSTERED</span>,
	twitter_id <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">100</span><span style="color: #808080;">&#41;</span>,
	published <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">30</span><span style="color: #808080;">&#41;</span>,
	title <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	content <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	updated <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">30</span><span style="color: #808080;">&#41;</span>,
	author_name <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">50</span><span style="color: #808080;">&#41;</span>,
	uri <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">100</span><span style="color: #808080;">&#41;</span>,
	keyword_searched <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">100</span><span style="color: #808080;">&#41;</span>
<span style="color: #808080;">&#41;</span>;</pre></td></tr></table></div>

<p>Now we can run the below script to use <a href="http://www.tweet-sql.com" target="_blank">Tweet-SQL</a> to store twitter search results in the above table. Just change the value set for <strong>@keyword</strong>.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p888code11'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p88811"><td class="code" id="p888code11"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">DECLARE</span> @xml XML,
        @handle <span style="color: #0000FF;">INT</span>,
        @keyword <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">100</span><span style="color: #808080;">&#41;</span>;
&nbsp;
<span style="color: #008080;">-- Set keyword to search for</span>
<span style="color: #0000FF;">SET</span> @keyword <span style="color: #808080;">=</span> <span style="color: #FF0000;">'Obama'</span>
&nbsp;
<span style="color: #008080;">-- Turn off resultset from Tweet-SQL</span>
<span style="color: #0000FF;">EXEC</span> dbo.<span style="color: #202020;">tweet_cfg_resultset_send</span> <span style="color: #000;">0</span>;
&nbsp;
<span style="color: #008080;">-- Peform a twitter search</span>
<span style="color: #0000FF;">EXEC</span> dbo.<span style="color: #202020;">tweet_src_search</span> @keyword, null, @xml <span style="color: #0000FF;">OUTPUT</span>;
&nbsp;
<span style="color: #008080;">-- Prepare an xml document</span>
<span style="color: #0000FF;">EXEC</span> <span style="color: #AF0000;">sp_xml_preparedocument</span> @handle <span style="color: #0000FF;">OUTPUT</span>, @xml, <span style="color: #FF0000;">'&lt;root xmlns:a=&quot;http://www.w3.org/2005/Atom&quot; /&gt;'</span>;
&nbsp;
&nbsp;
<span style="color: #0000FF;">INSERT</span> <span style="color: #0000FF;">INTO</span> dbo.<span style="color: #202020;">TwitterSearchResults</span>
<span style="color: #808080;">&#40;</span>
	twitter_id,
	published,
	title,
	content,
	updated,
	author_name,
	uri,
	keyword_searched
<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #808080;">&#91;</span>a:id<span style="color: #808080;">&#93;</span>,
	   <span style="color: #808080;">&#91;</span>a:published<span style="color: #808080;">&#93;</span>,
	   <span style="color: #808080;">&#91;</span>a:title<span style="color: #808080;">&#93;</span>,
	   <span style="color: #808080;">&#91;</span>a:content<span style="color: #808080;">&#93;</span>,
	   <span style="color: #808080;">&#91;</span>a:updated<span style="color: #808080;">&#93;</span>,
	   <span style="color: #808080;">&#91;</span>author_name<span style="color: #808080;">&#93;</span>,
	   <span style="color: #808080;">&#91;</span>uri<span style="color: #808080;">&#93;</span>,
	   @keyword <span style="color: #008080;">-- Store the keyword associated with this search</span>
<span style="color: #0000FF;">FROM</span> <span style="color: #0000FF;">OPENXML</span> <span style="color: #808080;">&#40;</span>@handle, <span style="color: #FF0000;">'//a:feed/a:entry'</span>, <span style="color: #000;">2</span><span style="color: #808080;">&#41;</span> <span style="color: #008080;">-- Path to tweets in the xml docs</span>
<span style="color: #0000FF;">WITH</span>
<span style="color: #808080;">&#40;</span>
	<span style="color: #808080;">&#91;</span>a:id<span style="color: #808080;">&#93;</span> <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	<span style="color: #808080;">&#91;</span>a:published<span style="color: #808080;">&#93;</span> <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	<span style="color: #808080;">&#91;</span>a:title<span style="color: #808080;">&#93;</span> <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	<span style="color: #808080;">&#91;</span>a:content<span style="color: #808080;">&#93;</span> <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	<span style="color: #808080;">&#91;</span>a:updated<span style="color: #808080;">&#93;</span> <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">160</span><span style="color: #808080;">&#41;</span>,
	author_name <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">100</span><span style="color: #808080;">&#41;</span> <span style="color: #FF0000;">'a:author/a:name'</span>, <span style="color: #008080;">-- Query further down the xml doc to get author info</span>
	uri <span style="color: #0000FF;">VARCHAR</span><span style="color: #808080;">&#40;</span><span style="color: #000;">100</span><span style="color: #808080;">&#41;</span> <span style="color: #FF0000;">'a:author/a:uri'</span>
 <span style="color: #808080;">&#41;</span>;
&nbsp;
<span style="color: #008080;">-- Clean up            </span>
<span style="color: #0000FF;">EXECUTE</span> <span style="color: #AF0000;">sp_xml_removedocument</span> @handle;
&nbsp;
<span style="color: #008080;">-- Turn on resultset from Tweet-SQL</span>
<span style="color: #0000FF;">EXEC</span> dbo.<span style="color: #202020;">tweet_cfg_resultset_send</span> <span style="color: #000;">1</span>;</pre></td></tr></table></div>

<p>Now the TwitterSearchResults table should contain and bunch of tweets.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p888code12'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p88812"><td class="code" id="p888code12"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">SELECT</span> <span style="color: #808080;">*</span> 
<span style="color: #0000FF;">FROM</span> dbo.<span style="color: #202020;">TwitterSearchResults</span>;</pre></td></tr></table></div>

<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/10/tweetsql_twitter_search_results.png"><img style="border-bottom: 0px; border-left: 0px; display: inline; border-top: 0px; border-right: 0px" title="tweet-sql twitter search results" border="0" alt="tweetsql twitter search results thumb Tweet SQL: Storing searches in a table" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/10/tweetsql_twitter_search_results_thumb.png" width="644" height="197" /></a> </p>
</p>
<p>Get yourself a copy of <a href="http://www.tweet-sql.com/dl.php" target="_blank">Tweet-SQL</a> and try this out now!</p>
<p><map name='google_ad_map_888_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/888?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_888_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=888&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Ftweet-sql-storing-searches-in-a-table%2F888' title="Tweet SQL: Storing searches in a table" alt=" Tweet SQL: Storing searches in a table" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/tweet-sql-storing-searches-in-a-table/888">Tweet-SQL: Storing searches in a table</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:80:"http://www.youdidwhatwithtsql.com/tweet-sql-storing-searches-in-a-table/888/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:5;a:6:{s:4:"data";s:41:"
		
		
		
		
		
				

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:47:"Powershell… Making it difficult for yourself!";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:81:"http://www.youdidwhatwithtsql.com/powershell-making-it-difficult-for-yourself/885";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:90:"http://www.youdidwhatwithtsql.com/powershell-making-it-difficult-for-yourself/885#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Thu, 21 Oct 2010 20:58:31 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:1:{i:0;a:5:{s:4:"data";s:10:"Powershell";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:81:"http://www.youdidwhatwithtsql.com/powershell-making-it-difficult-for-yourself/885";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:580:"Today I was reading the post Powershell is Really Easy… If you know what you’re doing and it really struck a chord with me. A few days ago I discovered the ConvertTo-HTML cmdlet that can easily convert Powershell objects into formatted html pages. As I’ve written a few scripts producing html output, by sticking together [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/powershell-making-it-difficult-for-yourself/885">Powershell&hellip; Making it difficult for yourself!</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:6427:"<p>Today I was reading the post <a href="http://scarydba.wordpress.com/2010/10/18/powershell-is-really-easy-if-you-know-what-youre-doing/">Powershell is Really Easy… If you know what you’re doing</a> and it really struck a chord with me. </p>
<p>A few days ago I discovered the <a href="http://technet.microsoft.com/en-us/library/ee156817.aspx" target="_blank">ConvertTo-HTML</a> cmdlet that can easily convert Powershell objects into formatted html pages. As I’ve written a few scripts producing html output, by sticking together a whole bunch of html tags, this was a real treat!</p>
<p>This simple one-liner will produce a html page from the output of the <a href="http://technet.microsoft.com/en-us/library/ee176858.aspx" target="_blank">Get-Service</a> cmdlet.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p885code15'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p88515"><td class="code" id="p885code15"><pre class="powershell" style="font-family:monospace;"><span style="color: #008080; font-weight: bold;">Get-Service</span> <span style="color: pink;">|</span> <span style="color: #008080; font-weight: bold;">ConvertTo-Html</span> <span style="color: pink;">|</span> <span style="color: #008080; font-weight: bold;">Out<span style="color: #FF0000;">-File</span></span> C:\Users\Rhys\Desktop\services.html;</pre></td></tr></table></div>

<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/10/ConvertToHTML_Output.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="ConvertTo-HTML Output from Get-Service" border="0" alt="ConvertToHTML Output thumb Powershell&hellip; Making it difficult for yourself!" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/10/ConvertToHTML_Output_thumb.png" width="244" height="133" /></a> </p>
<p>As usual Powershell gives us loads of options to use with this cmdlet. We can specify a css file uri, title tags and if objects should be formatted as a list or a table. I do a lot of formatting, that the cmdlet can’t accommodate, in my html reports so I like using the –Fragment parameter which will output the html for a table only. This allows me to produce some fairly fancy looking reports by adding custom html.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p885code16'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p88516"><td class="code" id="p885code16"><pre class="powershell" style="font-family:monospace;"><span style="color: #008080; font-weight: bold;">Get-Service</span> <span style="color: pink;">|</span> <span style="color: #008080; font-weight: bold;">Select-Object</span> <span style="color: #008080; font-style: italic;">-First</span> <span style="color: #804000;">1</span> <span style="color: pink;">|</span> <span style="color: #008080; font-weight: bold;">ConvertTo-Html</span> <span style="color: pink;">-</span>Fragment;</pre></td></tr></table></div>

<p>This spits out html like below…</p>
<pre>&lt;table&gt;
&lt;colgroup&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;col/&gt;
&lt;/colgroup&gt;
&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;RequiredServices&lt;/th&gt;&lt;th&gt;CanPauseAndContinue&lt;/th&gt;&lt;th&gt;CanShutdown&lt;/th&gt;&lt;th&gt;CanStop&lt;/th&gt;&lt;th&gt;DisplayName&lt;/th&gt;&lt;th&gt;DependentServices&lt;/th&gt;&lt;th&gt;MachineName
&lt;/th&gt;&lt;th&gt;ServiceName&lt;/th&gt;&lt;th&gt;ServicesDependedOn&lt;/th&gt;&lt;th&gt;ServiceHandle&lt;/th&gt;&lt;th&gt;Status&lt;/th&gt;&lt;th&gt;ServiceType&lt;/th&gt;&lt;th&gt;Site&lt;/th&gt;&lt;th&gt;Container&lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;ACDaemon&lt;/td&gt;&lt;td&gt;System.ServiceProcess.ServiceController[]&lt;/td&gt;&lt;td&gt;False&lt;/td&gt;&lt;td&gt;False&lt;/td&gt;&lt;td&gt;False&lt;/td&gt;&lt;td&gt;ArcSoft Connect Daemon&lt;/td&gt;&lt;td&gt;System.ServiceProce
ss.ServiceController[]&lt;/td&gt;&lt;td&gt;.&lt;/td&gt;&lt;td&gt;ACDaemon&lt;/td&gt;&lt;td&gt;System.ServiceProcess.ServiceController[]&lt;/td&gt;&lt;td&gt;SafeServiceHandle&lt;/td&gt;&lt;td&gt;Stopped&lt;/td&gt;&lt;td&gt;Win32OwnProcess&lt;/
td&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;/td&gt;&lt;/tr&gt;
&lt;/table&gt;</pre>
<p>So generally it’s much easier than cobbling together html tags yourself. I guess the lesson here is that I often tend to pick and run with something a bit prematurely. I should probably spend more time reading the documentation and learning a <strike>little</strike> lot more about what is available. Time for me to get digging into <a href="http://www.jonathanmedd.net/2010/09/powershell-2-0-one-cmdlet-at-a-time-available-as-pdf-download.html" target="_blank">One Cmdlet at a time</a>.</p>
<p><map name='google_ad_map_885_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/885?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_885_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=885&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fpowershell-making-it-difficult-for-yourself%2F885' title="Powershell&hellip; Making it difficult for yourself!" alt=" Powershell&hellip; Making it difficult for yourself!" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/powershell-making-it-difficult-for-yourself/885">Powershell&hellip; Making it difficult for yourself!</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:86:"http://www.youdidwhatwithtsql.com/powershell-making-it-difficult-for-yourself/885/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:6;a:6:{s:4:"data";s:50:"
		
		
		
		
		
				
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:51:"Gathering SQL Server Data Cache Information: Part 2";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:88:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information-part-2/879";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:97:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information-part-2/879#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Wed, 29 Sep 2010 14:20:18 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:4:{i:0;a:5:{s:4:"data";s:3:"DBA";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:10:"Powershell";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:10:"SQL Server";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:10:"data cache";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:88:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information-part-2/879";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:553:"In a previous post I showed how you can collect information on what is held in the data cache. The data collected here was just a simple summary of how much space each database was consuming. While useful we will need more detailed information on what is inside the cache to get a proper handle [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information-part-2/879">Gathering SQL Server Data Cache Information: Part 2</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:15601:"<p>In a previous post I showed how you can collect information on <a href="http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874" target="_blank">what is held in the data cache</a>. The data collected here was just a simple summary of how much space each database was consuming. While useful we will need more detailed information on what is inside the cache to get a proper handle on things.</p>
<p>The below query has been modified from the post: <a href="http://blogs.msdn.com/b/sqlperf/archive/2007/05/18/bufferpooldatapagesbreakdown.aspx" target="_blank">What’s swimming in your buffer pool?</a> This procedure will tell us exactly what objects are contained within the data cache.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p879code20'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87920"><td class="code" id="p879code20"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">SET</span> ANSI_<span style="color: #808080;">NULL</span>S <span style="color: #0000FF;">ON</span>
GO
&nbsp;
<span style="color: #0000FF;">SET</span> QUOTED_IDENTIFIER <span style="color: #0000FF;">ON</span>
GO
&nbsp;
&nbsp;
<span style="color: #008080;">-- =============================================</span>
<span style="color: #008080;">-- Author:		Rhys Campbell</span>
<span style="color: #008080;">-- Create date: 2010-09-28</span>
<span style="color: #008080;">-- Description:	Gets info on objects in the data</span>
<span style="color: #008080;">-- cache broken by database.</span>
<span style="color: #008080;">-- =============================================</span>
<span style="color: #0000FF;">CREATE</span> <span style="color: #0000FF;">PROCEDURE</span> <span style="color: #808080;">&#91;</span>dbo<span style="color: #808080;">&#93;</span>.<span style="color: #808080;">&#91;</span>GetDataCacheObjects<span style="color: #808080;">&#93;</span>
<span style="color: #0000FF;">AS</span>
<span style="color: #0000FF;">BEGIN</span>
	<span style="color: #008080;">-- SET NOCOUNT ON added to prevent extra result sets from</span>
	<span style="color: #008080;">-- interfering with SELECT statements.</span>
	<span style="color: #0000FF;">SET</span> <span style="color: #0000FF;">NOCOUNT</span> <span style="color: #0000FF;">ON</span>;
&nbsp;
    <span style="color: #0000FF;">SELECT</span> <span style="color: #FF00FF;">@@SERVERNAME</span> <span style="color: #0000FF;">AS</span> <span style="color: #FF0000;">'Server'</span>,
		   <span style="color: #FF00FF;">GETDATE</span><span style="color: #808080;">&#40;</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">AS</span> collected_at,
		   <span style="color: #FF00FF;">DB_NAME</span><span style="color: #808080;">&#40;</span>database_id<span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">AS</span> <span style="color: #FF0000;">'database'</span>,
		   <span style="color: #FF00FF;">COUNT</span><span style="color: #808080;">&#40;</span><span style="color: #808080;">*</span><span style="color: #808080;">&#41;</span><span style="color: #0000FF;">AS</span> cached_pages_count,
		   obj.<span style="color: #202020;">name</span> <span style="color: #0000FF;">AS</span> objectname,
		   ind.<span style="color: #202020;">name</span> <span style="color: #0000FF;">AS</span> indexname,
		   obj.<span style="color: #202020;">index_id</span> <span style="color: #0000FF;">AS</span> indexid
	<span style="color: #0000FF;">FROM</span> sys.<span style="color: #202020;">dm_os_buffer_descriptors</span> <span style="color: #0000FF;">AS</span> bd
    <span style="color: #0000FF;">INNER</span> <span style="color: #808080;">JOIN</span>
    <span style="color: #808080;">&#40;</span>
        <span style="color: #0000FF;">SELECT</span>       <span style="color: #FF00FF;">object_id</span> <span style="color: #0000FF;">AS</span> objectid,
                           <span style="color: #FF00FF;">object_name</span><span style="color: #808080;">&#40;</span><span style="color: #FF00FF;">object_id</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">AS</span> name,
                           index_id,allocation_unit_id
        <span style="color: #0000FF;">FROM</span> sys.<span style="color: #202020;">allocation_units</span> <span style="color: #0000FF;">AS</span> au
            <span style="color: #0000FF;">INNER</span> <span style="color: #808080;">JOIN</span> sys.<span style="color: #202020;">partitions</span> <span style="color: #0000FF;">AS</span> p
                <span style="color: #0000FF;">ON</span> au.<span style="color: #202020;">container_id</span> <span style="color: #808080;">=</span> p.<span style="color: #202020;">hobt_id</span>
                    <span style="color: #808080;">AND</span> <span style="color: #808080;">&#40;</span>au.<span style="color: #202020;">type</span> <span style="color: #808080;">=</span> <span style="color: #000;">1</span> <span style="color: #808080;">OR</span> au.<span style="color: #202020;">type</span> <span style="color: #808080;">=</span> <span style="color: #000;">3</span><span style="color: #808080;">&#41;</span>
        <span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
        <span style="color: #0000FF;">SELECT</span>       <span style="color: #FF00FF;">object_id</span> <span style="color: #0000FF;">AS</span> objectid,
                           <span style="color: #FF00FF;">object_name</span><span style="color: #808080;">&#40;</span><span style="color: #FF00FF;">object_id</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">AS</span> name,
                           index_id,allocation_unit_id
        <span style="color: #0000FF;">FROM</span> sys.<span style="color: #202020;">allocation_units</span> <span style="color: #0000FF;">AS</span> au
            <span style="color: #0000FF;">INNER</span> <span style="color: #808080;">JOIN</span> sys.<span style="color: #202020;">partitions</span> <span style="color: #0000FF;">AS</span> p
                <span style="color: #0000FF;">ON</span> au.<span style="color: #202020;">container_id</span> <span style="color: #808080;">=</span> p.<span style="color: #202020;">partition_id</span>
                    <span style="color: #808080;">AND</span> au.<span style="color: #202020;">type</span> <span style="color: #808080;">=</span> <span style="color: #000;">2</span>
    <span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">AS</span> obj
        <span style="color: #0000FF;">ON</span> bd.<span style="color: #202020;">allocation_unit_id</span> <span style="color: #808080;">=</span> obj.<span style="color: #202020;">allocation_unit_id</span>
	<span style="color: #0000FF;">LEFT</span> <span style="color: #808080;">OUTER</span> <span style="color: #808080;">JOIN</span> sys.<span style="color: #202020;">indexes</span> ind 
		<span style="color: #0000FF;">ON</span>  obj.<span style="color: #202020;">objectid</span> <span style="color: #808080;">=</span> ind.<span style="color: #FF00FF;">object_id</span>
	<span style="color: #808080;">AND</span>  obj.<span style="color: #202020;">index_id</span> <span style="color: #808080;">=</span> ind.<span style="color: #202020;">index_id</span>
	<span style="color: #0000FF;">WHERE</span> bd.<span style="color: #202020;">page_type</span> <span style="color: #808080;">IN</span> <span style="color: #808080;">&#40;</span><span style="color: #FF0000;">'data_page'</span>, <span style="color: #FF0000;">'index_page'</span><span style="color: #808080;">&#41;</span>
	<span style="color: #0000FF;">GROUP</span> <span style="color: #0000FF;">BY</span> <span style="color: #FF00FF;">DB_NAME</span><span style="color: #808080;">&#40;</span>database_id<span style="color: #808080;">&#41;</span>, obj.<span style="color: #202020;">name</span>, ind.<span style="color: #202020;">name</span>, obj.<span style="color: #202020;">index_id</span>
	<span style="color: #0000FF;">ORDER</span> <span style="color: #0000FF;">BY</span> cached_pages_count <span style="color: #0000FF;">DESC</span>
&nbsp;
<span style="color: #0000FF;">END</span>
&nbsp;
&nbsp;
GO</pre></td></tr></table></div>

<p>This will produce a dataset similar to below.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/objects_in_the_sql_server_data_cache.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="objects in the sql server data cache" border="0" alt="objects in the sql server data cache thumb Gathering SQL Server Data Cache Information: Part 2" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/objects_in_the_sql_server_data_cache_thumb.png" width="644" height="294" /></a> </p>
<p>This proc can be called by the <a href="http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874" target="_blank">Powershell script in the previous post</a> (nice and easy to run against multiple servers) and will produce a csv file looking like below. Just change the line </p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p879code21'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87921"><td class="code" id="p879code21"><pre class="powershell" style="font-family:monospace;"><span style="color: #800080;">$proc</span> <span style="color: pink;">=</span> <span style="color: #800000;">&quot;EXEC dbo.GetDataCache&quot;</span>;</pre></td></tr></table></div>

<p>to</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p879code22'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87922"><td class="code" id="p879code22"><pre class="powershell" style="font-family:monospace;"><span style="color: #800080;">$proc</span> <span style="color: pink;">=</span> <span style="color: #800000;">&quot;EXEC dbo.GetDataCacheObjects&quot;</span>;</pre></td></tr></table></div>

<p>This is ready to be imported into a database for future analysis.</p>
<pre>&quot;Server&quot;,&quot;collected_at&quot;,&quot;database&quot;,&quot;cached_pages_count&quot;,&quot;objectname&quot;,&quot;indexname&quot;,&quot;indexid&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;1167&quot;,&quot;sysobjvalues&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;304&quot;,&quot;syscolpars&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;190&quot;,&quot;tweet_followersIds&quot;,&quot;PK__tweet_fo__3214EC0735DCF99B&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;56&quot;,&quot;sysschobjs&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;test&quot;,&quot;32&quot;,&quot;sysobjvalues&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;27&quot;,&quot;sysobjkeycrypts&quot;,&quot;cl&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;msdb&quot;,&quot;25&quot;,&quot;sysschobjs&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;master&quot;,&quot;22&quot;,&quot;sysobjvalues&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;msdb&quot;,&quot;14&quot;,&quot;sysobjvalues&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;test&quot;,&quot;13&quot;,&quot;syscolpars&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;msdb&quot;,&quot;13&quot;,&quot;syscolpars&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;12&quot;,&quot;sysrscols&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;msdb&quot;,&quot;12&quot;,&quot;sysrscols&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;master&quot;,&quot;11&quot;,&quot;sysrscols&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;msdb&quot;,&quot;10&quot;,&quot;sysobjkeycrypts&quot;,&quot;cl&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;9&quot;,&quot;sysschobjs&quot;,&quot;nc2&quot;,&quot;3&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;&quot;,&quot;8&quot;,&quot;sysidxstats&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;model&quot;,&quot;8&quot;,&quot;sysobjvalues&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;model&quot;,&quot;8&quot;,&quot;sysrscols&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;tempdb&quot;,&quot;8&quot;,&quot;sysobjvalues&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;tempdb&quot;,&quot;8&quot;,&quot;sysrscols&quot;,&quot;clst&quot;,&quot;1&quot;
&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;29/09/2010 14:58:32&quot;,&quot;test&quot;,&quot;8&quot;,&quot;sysrscols&quot;,&quot;clst&quot;,&quot;1&quot;</pre>
<p>Once several snapshots of the data cache have been made this should help us with performance problem diagnosis and estimate the “warm-up time” after a reboot.</p>
<p><map name='google_ad_map_879_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/879?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_879_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=879&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fgathering-sql-server-data-cache-information-part-2%2F879' title="Gathering SQL Server Data Cache Information: Part 2" alt=" Gathering SQL Server Data Cache Information: Part 2" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information-part-2/879">Gathering SQL Server Data Cache Information: Part 2</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:93:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information-part-2/879/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:7;a:6:{s:4:"data";s:53:"
		
		
		
		
		
				
		
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:43:"Gathering SQL Server Data Cache Information";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:81:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:90:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Tue, 28 Sep 2010 12:17:59 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:5:{i:0;a:5:{s:4:"data";s:3:"DBA";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:10:"Powershell";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:10:"SQL Server";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:11:"buffer pool";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:4;a:5:{s:4:"data";s:10:"data cache";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:81:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:555:"I’m currently building a CMDB at work and I wanted to include a bit of performance data in the information collected. The data cache is probably the biggest consumer of memory within SQL Server so It makes sense to collect this for future analysis. As a start I’m gathering the amount of space each database [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874">Gathering SQL Server Data Cache Information</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:11800:"<p>I’m currently building a <a href="http://en.wikipedia.org/wiki/Configuration_management_database" target="_blank">CMDB</a> at work and I wanted to include a bit of performance data in the information collected. The data cache is probably the biggest consumer of memory within SQL Server so It makes sense to collect this for future analysis. As a start I’m gathering the amount of space each database consumes in the data cache. I’ve created the below proc from a query in the excellent <a href="http://www.brentozar.com/archive/2009/12/pro-sql-server-2008-internals-and-troubleshooting/" target="_blank">Pro SQL Server 2008 Internals &amp; Troubleshooting</a>.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p874code25'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87425"><td class="code" id="p874code25"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">SET</span> ANSI_<span style="color: #808080;">NULL</span>S <span style="color: #0000FF;">ON</span>
GO
<span style="color: #0000FF;">SET</span> QUOTED_IDENTIFIER <span style="color: #0000FF;">ON</span>
GO
<span style="color: #008080;">-- =============================================</span>
<span style="color: #008080;">-- Author:		Rhys Campbell</span>
<span style="color: #008080;">-- Create date: 2010-09-28</span>
<span style="color: #008080;">-- Description:	Provides a summary of how much</span>
<span style="color: #008080;">-- space each database is using in the data cache</span>
<span style="color: #008080;">-- =============================================</span>
<span style="color: #0000FF;">CREATE</span> <span style="color: #0000FF;">PROCEDURE</span> GetDataCache
<span style="color: #0000FF;">AS</span>
<span style="color: #0000FF;">BEGIN</span>
&nbsp;
	<span style="color: #0000FF;">SET</span> <span style="color: #0000FF;">NOCOUNT</span> <span style="color: #0000FF;">ON</span>;
&nbsp;
    <span style="color: #0000FF;">SELECT</span> <span style="color: #FF00FF;">COUNT</span><span style="color: #808080;">&#40;</span><span style="color: #808080;">*</span><span style="color: #808080;">&#41;</span> <span style="color: #808080;">*</span> <span style="color: #000;">8</span> <span style="color: #808080;">/</span> <span style="color: #000;">1024</span> <span style="color: #0000FF;">AS</span> <span style="color: #FF0000;">'Cache Size (MB)'</span>,
		   <span style="color: #0000FF;">CASE</span> database_id
				<span style="color: #0000FF;">WHEN</span> <span style="color: #000;">32767</span> <span style="color: #0000FF;">THEN</span> <span style="color: #FF0000;">'ResourceDb'</span>
				<span style="color: #0000FF;">ELSE</span> <span style="color: #FF00FF;">DB_NAME</span><span style="color: #808080;">&#40;</span>database_id<span style="color: #808080;">&#41;</span>
		   <span style="color: #0000FF;">END</span> <span style="color: #0000FF;">AS</span> <span style="color: #FF0000;">'Database'</span>,
		   <span style="color: #FF00FF;">@@SERVERNAME</span> <span style="color: #0000FF;">AS</span> <span style="color: #FF0000;">'Server'</span>,
		   <span style="color: #FF00FF;">GETDATE</span><span style="color: #808080;">&#40;</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">AS</span> <span style="color: #FF0000;">'collected_at'</span>
	<span style="color: #0000FF;">FROM</span> sys.<span style="color: #202020;">dm_os_buffer_descriptors</span>
	<span style="color: #0000FF;">GROUP</span> <span style="color: #0000FF;">BY</span> <span style="color: #FF00FF;">DB_NAME</span><span style="color: #808080;">&#40;</span>database_id<span style="color: #808080;">&#41;</span>, database_id
	<span style="color: #0000FF;">ORDER</span> <span style="color: #0000FF;">BY</span> <span style="color: #FF0000;">'Cache Size (MB)'</span> <span style="color: #0000FF;">DESC</span>;
&nbsp;
<span style="color: #0000FF;">END</span>
GO</pre></td></tr></table></div>

<p>This will produce a dataset similar to below.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/sql_data_cache_use_by_database.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="sql data cache use by database" border="0" alt="sql data cache use by database thumb Gathering SQL Server Data Cache Information" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/sql_data_cache_use_by_database_thumb.png" width="644" height="134" /></a> </p>
</p>
<p>I’ve written a <a href="http://technet.microsoft.com/en-us/scriptcenter/powershell.aspx" target="_blank">Powershell</a> script to make it easy to query multiple servers. The script assumes that each sql instance to be queried contains the same database with the above proc. This script should be able to call any procedure as it simply exports the resultset to a csv file.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p874code26'); return false;">View Code</a> POWERSHELL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87426"><td class="code" id="p874code26"><pre class="powershell" style="font-family:monospace;"><span style="color: #008000;"># array of sql server instances to query</span>
<span style="color: #800080;">$instances</span> <span style="color: pink;">=</span> <span style="color: pink;">@</span><span style="color: #000000;">&#40;</span><span style="color: #800000;">&quot;localhost\sqlexpress&quot;</span><span style="color: pink;">,</span> <span style="color: #800000;">&quot;RHYS-VAIO\sqlexpress&quot;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #008000;"># assumes proc is located in the same db on all servers</span>
<span style="color: #800080;">$database</span> <span style="color: pink;">=</span> <span style="color: #800000;">&quot;test&quot;</span>;
<span style="color: #008000;"># proc to call</span>
<span style="color: #800080;">$proc</span> <span style="color: pink;">=</span> <span style="color: #800000;">&quot;EXEC dbo.GetDataCache&quot;</span>;
<span style="color: #008000;"># Datetime stamp for filename</span>
<span style="color: #800080;">$dt</span> <span style="color: pink;">=</span> <span style="color: #008080; font-weight: bold;">Get-Date</span> <span style="color: #008080; font-style: italic;">-Format</span> <span style="color: #800000;">&quot;yyyyMMddHHmmss&quot;</span>;
&nbsp;
<span style="color: #008000;"># Query each instance</span>
<span style="color: #0000FF;">foreach</span><span style="color: #000000;">&#40;</span><span style="color: #800080;">$sql_instance</span> <span style="color: #0000FF;">in</span> <span style="color: #800080;">$instances</span><span style="color: #000000;">&#41;</span>
<span style="color: #000000;">&#123;</span>
	<span style="color: #800080;">$con</span> <span style="color: pink;">=</span> <span style="color: #008080; font-weight: bold;">New-Object</span> System.Data.SqlClient.SqlConnection<span style="color: #000000;">&#40;</span><span style="color: #800000;">&quot;Data Source=$sql_instance;Integrated Security=true;Initial Catalog=$database&quot;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #800080;">$resultset</span> <span style="color: pink;">=</span> <span style="color: #008080; font-weight: bold;">New-Object</span> <span style="color: #800000;">&quot;System.Data.DataSet&quot;</span> <span style="color: #800000;">&quot;myDs&quot;</span>;
	<span style="color: #800080;">$data_adap</span> <span style="color: pink;">=</span> <span style="color: #008080; font-weight: bold;">new-object</span> <span style="color: #800000;">&quot;System.Data.SqlClient.SqlDataAdapter&quot;</span> <span style="color: #000000;">&#40;</span><span style="color: #800080;">$proc</span><span style="color: pink;">,</span> <span style="color: #800080;">$con</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #800080;">$data_adap</span>.Fill<span style="color: #000000;">&#40;</span><span style="color: #800080;">$resultset</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #008000;"># Replace any '\' chars from instance names to use in the filename</span>
	<span style="color: #800080;">$tmp_srv</span> <span style="color: pink;">=</span> <span style="color: #800080;">$sql_instance</span> <span style="color: #FF0000;">-replace</span> <span style="color: #800000;">&quot;\\&quot;</span><span style="color: pink;">,</span> <span style="color: #800000;">&quot;_&quot;</span>;
	<span style="color: #008000;"># Add data to csv file</span>
	<span style="color: #800080;">$resultset</span>.Tables<span style="color: #000000;">&#91;</span><span style="color: #804000;">0</span><span style="color: #000000;">&#93;</span> <span style="color: pink;">|</span> <span style="color: #008080; font-weight: bold;">Export-Csv</span> <span style="color: #008080; font-style: italic;">-NoTypeInformation</span> <span style="color: #008080; font-style: italic;">-Path</span> <span style="color: #800000;">&quot;$Env:USERPROFILE\$tmp_srv<span style="color: #008080; font-weight: bold;">`_</span>sql_data_cache_$dt.csv&quot;</span>;
	<span style="color: #008000;"># Clean up</span>
	<span style="color: #800080;">$resultset</span>.Dispose<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
	<span style="color: #800080;">$con</span>.Close<span style="color: #000000;">&#40;</span><span style="color: #000000;">&#41;</span>;
<span style="color: #000000;">&#125;</span></pre></td></tr></table></div>

<p>The script will spit out a csv file for each sql instance ready to be imported into the CMDB.</p>
<pre>&quot;Cache Size (MB)&quot;,&quot;Database&quot;,&quot;Server&quot;,&quot;collected_at&quot;
&quot;0&quot;,&quot;master&quot;,&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;28/09/2010 13:12:52&quot;
&quot;0&quot;,&quot;msdb&quot;,&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;28/09/2010 13:12:52&quot;
&quot;1&quot;,&quot;test&quot;,&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;28/09/2010 13:12:52&quot;
&quot;20&quot;,&quot;TweetSQLV3&quot;,&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;28/09/2010 13:12:52&quot;
&quot;1&quot;,&quot;tweetsql_31&quot;,&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;28/09/2010 13:12:52&quot;
&quot;0&quot;,&quot;ResourceDb&quot;,&quot;RHYS-VAIO\SQLEXPRESS&quot;,&quot;28/09/2010 13:12:52&quot;</pre>
<p><map name='google_ad_map_874_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/874?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_874_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=874&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fgathering-sql-server-data-cache-information%2F874' title="Gathering SQL Server Data Cache Information" alt=" Gathering SQL Server Data Cache Information" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874">Gathering SQL Server Data Cache Information</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:86:"http://www.youdidwhatwithtsql.com/gathering-sql-server-data-cache-information/874/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:8;a:6:{s:4:"data";s:50:"
		
		
		
		
		
				
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:28:"Using sp_rename with schemas";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:66:"http://www.youdidwhatwithtsql.com/using-sp_rename-with-schemas/870";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:75:"http://www.youdidwhatwithtsql.com/using-sp_rename-with-schemas/870#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Thu, 23 Sep 2010 21:22:50 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:4:{i:0;a:5:{s:4:"data";s:3:"DBA";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:5:"T-SQL";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:7:"schemas";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:8:"schemata";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:66:"http://www.youdidwhatwithtsql.com/using-sp_rename-with-schemas/870";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:565:"I’ve noticed people before struggling using sp_rename with tables that aren’t in the default schema. Many people don’t use schemas, so there’s often confusion, when they finally do come across the need to rename a table belonging to another schema. Assuming the below ‘Suppliers’ table is in the users default schema (usually dbo) then the [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/using-sp_rename-with-schemas/870">Using sp_rename with schemas</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:5227:"<p>I’ve noticed people before struggling using <a href="http://msdn.microsoft.com/en-us/library/ms188351.aspx" target="_blank">sp_rename</a> with tables that aren’t in the default schema. Many people don’t use schemas, so there’s often confusion, when they finally do come across the need to rename a table belonging to another schema.</p>
<p>Assuming the below ‘<font color="#666666">Suppliers’ table is in the users default schema (usually dbo) then the following will work as expected.</font></p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p870code31'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87031"><td class="code" id="p870code31"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">EXEC</span> <span style="color: #AF0000;">sp_rename</span> <span style="color: #FF0000;">'Suppliers'</span>, <span style="color: #FF0000;">'Suppliers2'</span>;</pre></td></tr></table></div>

<pre>Caution: Changing any part of an object name could break scripts and stored procedures.</pre>
<p>If the table had not been in the users default schema the following error would have occurred.</p>
<pre>Msg 15225, Level 11, State 1, Procedure sp_rename, Line 338
No item by the name of 'Suppliers' could be found in the current database 'test', given that @itemtype was input as '(null)'.</pre>
<p>After encountering this many people then figure, quite correctly, that the schema should be referenced but get it slightly wrong.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p870code32'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87032"><td class="code" id="p870code32"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">EXEC</span> <span style="color: #AF0000;">sp_rename</span> <span style="color: #FF0000;">'AnotherSchema.Suppliers'</span>, <span style="color: #FF0000;">'AnotherSchema.Suppliers2'</span>;</pre></td></tr></table></div>

<p>This works, but not in the way you want, you end up with a table called <strong>AnotherSchema.Suppliers2</strong>. This can then only be referenced by using the following structure; <strong>AnotherSchema.[AnotherSchema.Suppliers2]</strong>. The correct syntax is; </strong></p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p870code33'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87033"><td class="code" id="p870code33"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">EXEC</span> <span style="color: #AF0000;">sp_rename</span> <span style="color: #FF0000;">'schema.old table name'</span>, <span style="color: #FF0000;">'new table name'</span>;</pre></td></tr></table></div>

<p>For example;</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p870code34'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p87034"><td class="code" id="p870code34"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">EXEC</span> <span style="color: #AF0000;">sp_rename</span> <span style="color: #FF0000;">'AnotherSchema.Suppliers'</span>, <span style="color: #FF0000;">'Suppliers2'</span>;</pre></td></tr></table></div>

<p><map name='google_ad_map_870_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/870?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_870_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=870&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fusing-sp_rename-with-schemas%2F870' title="Using sp rename with schemas" alt=" Using sp rename with schemas" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/using-sp_rename-with-schemas/870">Using sp_rename with schemas</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:71:"http://www.youdidwhatwithtsql.com/using-sp_rename-with-schemas/870/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"0";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}i:9;a:6:{s:4:"data";s:50:"
		
		
		
		
		
				
		
		
		

		
		
			
			
		
		";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";s:5:"child";a:5:{s:0:"";a:7:{s:5:"title";a:1:{i:0;a:5:{s:4:"data";s:40:"Deleting sequential duplicates with TSQL";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:78:"http://www.youdidwhatwithtsql.com/deleting-sequential-duplicates-with-tsql/869";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:87:"http://www.youdidwhatwithtsql.com/deleting-sequential-duplicates-with-tsql/869#comments";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:7:"pubDate";a:1:{i:0;a:5:{s:4:"data";s:31:"Wed, 01 Sep 2010 17:02:42 +0000";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:8:"category";a:4:{i:0;a:5:{s:4:"data";s:5:"T-SQL";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:1;a:5:{s:4:"data";s:10:"duplicates";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:2;a:5:{s:4:"data";s:10:"SQL Server";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}i:3;a:5:{s:4:"data";s:4:"TSQL";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:4:"guid";a:1:{i:0;a:5:{s:4:"data";s:78:"http://www.youdidwhatwithtsql.com/deleting-sequential-duplicates-with-tsql/869";s:7:"attribs";a:1:{s:0:"";a:1:{s:11:"isPermaLink";s:5:"false";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:11:"description";a:1:{i:0;a:5:{s:4:"data";s:529:"I was recently given a du-duping task which was much more difficult than I anticipated and taxed my SQL brain to its limits. I thought of using a CTE to do this but all of the examples I could find for deleting records with a CTE wouldn’t have worked in my situation. Essentially the table [...]<p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/deleting-sequential-duplicates-with-tsql/869">Deleting sequential duplicates with TSQL</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:32:"http://purl.org/dc/elements/1.1/";a:1:{s:7:"creator";a:1:{i:0;a:5:{s:4:"data";s:4:"Rhys";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:40:"http://purl.org/rss/1.0/modules/content/";a:1:{s:7:"encoded";a:1:{i:0;a:5:{s:4:"data";s:23150:"<p>I was recently given a du-duping task which was much more difficult than I anticipated and taxed my SQL brain to its limits. I thought of using a <a href="http://msdn.microsoft.com/en-us/library/ms190766.aspx" target="_blank">CTE</a> to do this but all of the examples I could find for <a href="http://blog.sqlauthority.com/2009/06/23/sql-server-2005-2008-delete-duplicate-rows/" target="_blank">deleting records with a CTE</a> wouldn’t have worked in my situation.</p>
<p>Essentially the table had a business key consisting of 3 parts. Each record would also come with two values attached. The current system pumped data into this fairly regularly and we only wanted to keep values that were not sequentially duplicated. By “sequentially duplicated” I mean an insert into a feed table has the same values attached as the previously inserted record for the same business key. For example, assuming a single key, the below table illustrates the input sequence and the desired de-dupe result.</p>
<table border="0" cellspacing="2" cellpadding="2" width="400">
<tbody>
<tr>
<td valign="top" width="200"><strong>sequence</strong></td>
<td valign="top" width="200"><strong>de-duped</strong></td>
</tr>
<tr>
<td valign="top" width="200">1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1</td>
<td valign="top" width="200">1</td>
</tr>
<tr>
<td valign="top" width="200">1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1</td>
<td valign="top" width="200">1,2,1</td>
</tr>
<tr>
<td valign="top" width="200">1,2,3,4,5,4,3,2,1</td>
<td valign="top" width="200">1,2,3,4,5,4,3,2,1</td>
</tr>
</tbody>
</table>
<p>Now for a SQL example;</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p869code38'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p86938"><td class="code" id="p869code38"><pre class="tsql" style="font-family:monospace;"><span style="color: #008080;">-- Create a test table</span>
<span style="color: #0000FF;">CREATE</span> <span style="color: #0000FF;">TABLE</span> dbo.<span style="color: #202020;">TestDupes</span>
<span style="color: #808080;">&#40;</span>
	Id <span style="color: #0000FF;">INTEGER</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span> <span style="color: #0000FF;">PRIMARY</span> <span style="color: #0000FF;">KEY</span> <span style="color: #0000FF;">CLUSTERED</span> <span style="color: #0000FF;">IDENTITY</span><span style="color: #808080;">&#40;</span><span style="color: #000;">1</span>,<span style="color: #000;">1</span><span style="color: #808080;">&#41;</span>,
	KeyPart1 <span style="color: #0000FF;">INTEGER</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span>,
	KeyPart2 <span style="color: #0000FF;">INTEGER</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span>,
	KeyPart3 <span style="color: #0000FF;">INTEGER</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span>,
	value1 <span style="color: #0000FF;">FLOAT</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span>,
	value2 <span style="color: #0000FF;">FLOAT</span> <span style="color: #808080;">NOT</span> <span style="color: #808080;">NULL</span>
<span style="color: #808080;">&#41;</span>;
GO
&nbsp;
<span style="color: #008080;">-- Insert some test data</span>
<span style="color: #0000FF;">INSERT</span> <span style="color: #0000FF;">INTO</span> dbo.<span style="color: #202020;">TestDupes</span>
<span style="color: #808080;">&#40;</span>
	KeyPart1,
	KeyPart2,
	KeyPart3,
	value1,
	value2
<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>;
GO</pre></td></tr></table></div>

<p>The records considered to be duplicates are outlined in red in the image below.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/sequential_dupes.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="sequential dupes" border="0" alt="sequential dupes thumb Deleting sequential duplicates with TSQL" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/sequential_dupes_thumb.png" width="644" height="451" /></a> </p>
<p>A sequentially de-duped dataset would look like below.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/no_sequential_dupes.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="no sequential dupes" border="0" alt="no sequential dupes thumb Deleting sequential duplicates with TSQL" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/no_sequential_dupes_thumb.png" width="644" height="282" /></a></p>
<p>The solution I came up with, after much head-scratching, involved the use of the <a href="http://msdn.microsoft.com/en-us/library/ms173825.aspx" target="_blank">DENSE_RANK</a> &amp; <a href="http://msdn.microsoft.com/en-us/library/ms186734.aspx" target="_blank">ROW_NUMBER</a> functions combined with a <a href="http://msdn.microsoft.com/en-us/library/ms190766.aspx" target="_blank">Common Table Expression</a>. The DENSE_RANK function organises each business key (KeyPart1, KeyPart2, KeyPart3) into groups. The ROW_NUMBER function gives us a sequence number for each record within the group. This is best illustrated with a select statement with another group thrown in for good measure.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p869code39'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p86939"><td class="code" id="p869code39"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">TRUNCATE</span> <span style="color: #0000FF;">TABLE</span> dbo.<span style="color: #202020;">TestDupes</span>;
<span style="color: #008080;">-- Insert some test data</span>
<span style="color: #0000FF;">INSERT</span> <span style="color: #0000FF;">INTO</span> dbo.<span style="color: #202020;">TestDupes</span>
<span style="color: #808080;">&#40;</span>
	KeyPart1,
	KeyPart2,
	KeyPart3,
	value1,
	value2
<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">1</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #008080;">-- Group 2 </span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">5.5</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>
<span style="color: #0000FF;">UNION</span> <span style="color: #808080;">ALL</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #000;">2</span>, <span style="color: #000;">2</span>, <span style="color: #000;">3</span>, <span style="color: #000;">2.0</span>, <span style="color: #000;">2.5</span>;
GO
&nbsp;
<span style="color: #0000FF;">WITH</span> Dupe_CTE <span style="color: #808080;">&#40;</span>
			Id, 
			KeyPart1, 
			KeyPart2, 
			KeyPart3, 
			value1, 
			value2, 
			group_num, 
			group_row_num
		<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">AS</span>
<span style="color: #808080;">&#40;</span>
	<span style="color: #0000FF;">SELECT</span> Id,
	       KeyPart1,
	       KeyPart2,
	       KeyPart3,
	       value1,
	       value2,
               DENSE_RANK<span style="color: #808080;">&#40;</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">OVER</span><span style="color: #808080;">&#40;</span><span style="color: #0000FF;">ORDER</span> <span style="color: #0000FF;">BY</span> KeyPart1, KeyPart2, KeyPart3<span style="color: #808080;">&#41;</span>,
               ROW_NUMBER<span style="color: #808080;">&#40;</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">OVER</span><span style="color: #808080;">&#40;</span>PARTITION <span style="color: #0000FF;">BY</span> KeyPart1,
                                          KeyPart2,
                                          KeyPart3
                                 <span style="color: #0000FF;">ORDER</span> <span style="color: #0000FF;">BY</span> Id<span style="color: #808080;">&#41;</span>
        <span style="color: #0000FF;">FROM</span> dbo.<span style="color: #202020;">TestDupes</span>
<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">SELECT</span> <span style="color: #808080;">*</span>
<span style="color: #0000FF;">FROM</span> Dupe_CTE;</pre></td></tr></table></div>

<p>Here you can see the data is organised into groups and each row, within the group, is numbered according to it&#8217;s position.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/feed_dupes_two_sets.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="duplicates organise into groups with DENSE_RANK" border="0" alt="feed dupes two sets thumb Deleting sequential duplicates with TSQL" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/feed_dupes_two_sets_thumb.png" width="582" height="484" /></a></p>
<p>Using this information about each group we can execute a delete. The delete self-joins to the CTE comparing the values for value1 and value2.</p>

<div class="wp_codebox_msgheader"><span class="right"><sup><a href="http://www.ericbess.com/ericblog/2008/03/03/wp-codebox/#examples" target="_blank" title="WP-CodeBox HowTo?"><span style="color: #99cc00">?</span></a></sup></span><span class="left"><a href="javascript:;" onclick="javascript:showCodeTxt('p869code40'); return false;">View Code</a> TSQL</span><div class="codebox_clear"></div></div><div class="wp_codebox"><table><tr id="p86940"><td class="code" id="p869code40"><pre class="tsql" style="font-family:monospace;"><span style="color: #0000FF;">WITH</span> Dupe_CTE <span style="color: #808080;">&#40;</span>
			Id, 
			KeyPart1, 
			KeyPart2, 
			KeyPart3, 
			value1, 
			value2, 
			group_num, 
			group_row_num
		<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">AS</span>
<span style="color: #808080;">&#40;</span>
	<span style="color: #0000FF;">SELECT</span> Id,
		   KeyPart1,
		   KeyPart2,
		   KeyPart3,
		   value1,
		   value2,
           DENSE_RANK<span style="color: #808080;">&#40;</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">OVER</span><span style="color: #808080;">&#40;</span><span style="color: #0000FF;">ORDER</span> <span style="color: #0000FF;">BY</span> KeyPart1, KeyPart2, KeyPart3<span style="color: #808080;">&#41;</span>,
           ROW_NUMBER<span style="color: #808080;">&#40;</span><span style="color: #808080;">&#41;</span> <span style="color: #0000FF;">OVER</span><span style="color: #808080;">&#40;</span>PARTITION <span style="color: #0000FF;">BY</span> KeyPart1,
                                          KeyPart2,
                                          KeyPart3
                             <span style="color: #0000FF;">ORDER</span> <span style="color: #0000FF;">BY</span> Id<span style="color: #808080;">&#41;</span>
           <span style="color: #0000FF;">FROM</span> dbo.<span style="color: #202020;">TestDupes</span>
<span style="color: #808080;">&#41;</span>
<span style="color: #0000FF;">DELETE</span> fg2
<span style="color: #0000FF;">FROM</span> Dupe_CTE fg1
<span style="color: #0000FF;">INNER</span> <span style="color: #808080;">JOIN</span> Dupe_CTE fg2
                <span style="color: #0000FF;">ON</span> fg1.<span style="color: #202020;">Group_Num</span> <span style="color: #808080;">=</span> fg2.<span style="color: #202020;">Group_Num</span>
                <span style="color: #808080;">AND</span> fg1.<span style="color: #202020;">value1</span> <span style="color: #808080;">=</span> fg2.<span style="color: #202020;">value1</span>
                <span style="color: #808080;">AND</span> fg1.<span style="color: #202020;">value2</span> <span style="color: #808080;">=</span> fg2.<span style="color: #202020;">value2</span>
<span style="color: #0000FF;">WHERE</span> fg1.<span style="color: #202020;">group_row_num</span> <span style="color: #808080;">=</span> fg2.<span style="color: #202020;">group_row_num</span> <span style="color: #808080;">-</span> <span style="color: #000;">1</span>;</pre></td></tr></table></div>

<p>This will remove any duplicates, keeping the oldest record in each case, giving us a clean dataset.</p>
<p><a href="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/cleaned_up_group_duplicates.png"><img style="border-right-width: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px" title="cleaned up group duplicates" border="0" alt="cleaned up group duplicates thumb Deleting sequential duplicates with TSQL" src="http://www.youdidwhatwithtsql.com/wp-content/uploads/2010/09/cleaned_up_group_duplicates_thumb.png" width="644" height="439" /></a></p>
<p>Can anyone think of a <strike>CURSOR</strike> better way of doing this?</p>
<p><map name='google_ad_map_869_a45beff5d2e172f6'>
<area shape='rect' href='http://imageads.googleadservices.com/pagead/imgclick/869?pos=0' coords='1,2,367,28' />
<area shape='rect' href='http://services.google.com/feedback/abg' coords='384,10,453,23'/></map>
<img usemap='#google_ad_map_869_a45beff5d2e172f6' border='0' src='http://imageads.googleadservices.com/pagead/ads?format=468x30_aff_img&amp;client=&amp;channel=&amp;output=png&amp;cuid=869&amp;url=http%3A%2F%2Fwww.youdidwhatwithtsql.com%2Fdeleting-sequential-duplicates-with-tsql%2F869' title="Deleting sequential duplicates with TSQL" alt=" Deleting sequential duplicates with TSQL" /></p><p>Post from: <a href="http://www.youdidwhatwithtsql.com">youdidwhatwithtsql.com</a><br/><br/><a href="http://www.youdidwhatwithtsql.com/deleting-sequential-duplicates-with-tsql/869">Deleting sequential duplicates with TSQL</a></p>
";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:36:"http://wellformedweb.org/CommentAPI/";a:1:{s:10:"commentRss";a:1:{i:0;a:5:{s:4:"data";s:83:"http://www.youdidwhatwithtsql.com/deleting-sequential-duplicates-with-tsql/869/feed";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:38:"http://purl.org/rss/1.0/modules/slash/";a:1:{s:8:"comments";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}}s:27:"http://www.w3.org/2005/Atom";a:1:{s:4:"link";a:1:{i:0;a:5:{s:4:"data";s:0:"";s:7:"attribs";a:1:{s:0:"";a:3:{s:4:"href";s:38:"http://www.youdidwhatwithtsql.com/feed";s:3:"rel";s:4:"self";s:4:"type";s:19:"application/rss+xml";}}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}s:44:"http://purl.org/rss/1.0/modules/syndication/";a:2:{s:12:"updatePeriod";a:1:{i:0;a:5:{s:4:"data";s:6:"hourly";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}s:15:"updateFrequency";a:1:{i:0;a:5:{s:4:"data";s:1:"1";s:7:"attribs";a:0:{}s:8:"xml_base";s:0:"";s:17:"xml_base_explicit";b:0;s:8:"xml_lang";s:0:"";}}}}}}}}}}}}s:7:"headers";a:11:{s:10:"connection";s:5:"close";s:4:"date";s:29:"Wed, 24 Nov 2010 07:02:34 GMT";s:6:"server";s:17:"Microsoft-IIS/6.0";s:12:"x-powered-by";s:19:"ASP.NET, PHP/5.2.12";s:10:"set-cookie";s:68:"wpmp_switcher=desktop; expires=Thu, 24-Nov-2011 07:02:32 GMT; path=/";s:10:"x-pingback";s:44:"http://www.youdidwhatwithtsql.com/xmlrpc.php";s:13:"last-modified";s:29:"Thu, 11 Nov 2010 20:29:41 GMT";s:4:"etag";s:32:"45c0ddfc2348f0d9556b56f7f5f6f088";s:14:"x-mobilized-by";s:27:"WordPress Mobile Pack 1.2.3";s:12:"content-type";s:23:"text/xml; charset=UTF-8";s:14:"content-length";s:6:"103077";}s:5:"build";s:14:"20070715235228";}